<!DOCTYPE html>
<html><head>
<meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8"/>
<title>Chronos</title>


<link rel="stylesheet" href="css/fontFile.css"> 

<link rel="styleSheet" href="css/sizeAndSpacing.css">
<link id="themeSelection" rel="styleSheet" href="css/defaultTheme.css">
<link id="windozeFixer" rel="styleSheet" href="">

<style>


/******** Specific to this page ********/


/*@media screen and (max-width: 3000px) {
	.leftContainer, .rightContainer { box-shadow: 0 0 3px 3px inset white; }
} */

@media screen and (min-width: 1260px) {
/*	.leftContainer, .rightContainer { max-width: 1000px; } */
	#container1 { max-width: 1230px; }
}

@media screen and (max-width: 1142px) { /* change formatting when screen size is narrower than this */
	#ioNav { display: none; } /* hide the IO config button */
}

@media screen and (max-width: 950px) { /* change formatting when screen size is narrower than this */
	#help { display: none; } /* hide the help button */

	body { margin: 0; }
}

@media screen and (max-width: 705px) { /* change formatting when screen size is narrower than this */
	.subTitle { display: none; }
}

@media screen and (max-width: 665px) { /* change formatting when screen size is narrower than this */
	#settings { display: none; }
}

@media screen and (max-width: 500px) { /* change formatting when screen size is narrower than this */
	#playSave { display: none; } /* hide the PlaySave button */
}

@media screen and (max-width: 455px) { /* change formatting when screen size is narrower than this */
	.titleImage img { width: 100%; height: auto; }
}

@media screen and (max-width: 365px) { /* change formatting when screen size is narrower than this */
	#main { display: none; } /* hide the main button */
	#menu { width: 90%; }
}

#batteryBar { margin-bottom: 2px; }
#container1 { margin-bottom: 6px; }

#combinatorialIconBox {
	width: 860px;
	max-width: 888px;
}

#simpleConfigText {
	margin-left: 10px;
	width: 270px;
}

#advancedConfigText {
	margin-left: 10px;
	width: 300px;
}

#ioMappingDelayTime { margin-top: 9px; }

#ioMappingDelayBox, #inputStatusBox { clear: left; }

#legendContainer {
	display: inline-block;
	float: right;	
}

#legendTrue, #legendFalse { width: 220px; }


</style>
</head>


<body onclick="">

	<div class="header">
		<div class="titleImage">
			<img id="logoImage" src="Chronos High Speed logo.png">
		</div>

		<!-- <b class="title">&nbsp;CHRONOS</b> -->
		<div class="subTitle">by <a href="https://www.krontech.ca" target="_blank">Kron Technologies</a></div>
	</div>

 <div class="mainContainer"> 

	
	<div class="heading-bar">
		<a id="main" href="./"> <div class="homeIcon"></div> Main </a>
		<a id="playSave" href="PlaySave.html"> <div class="playIcon"></div> Play & Save </a>
		<a id="settings" href="settings.html"> <div class="settingsIcon"></div> Settings </a>
		<a id="ioNav" class="active"> <div class="ioIcon"></div> I/O Config </a>
		<a id="help" href="/apidoc/"> <div class="helpIcon">?</div> Documentation </a>

		<a id="menu" onclick="toggler(this)" class="menuClickOk"> <div class="menuIcon"></div> Menu </a>
		<div id="menuList" onmouseover="menuKeeper()" class="menuContainer menuClickOk">
			<a href="/"> Record (Main) </a>
			<a href="PlaySave.html"> Play & Save </a>
			<a href="/settings.html"> Camera Settings </a>
			<a href="IO.html"> I/O Configuration </a>
			<a href="/apidoc/"> Documentation </a>
			<a onclick="dropDownSelect(this)">Play Mode</a>
			<a onclick="dropDownSelect(this)">Record Mode</a>
<!--
			<a onclick="dropDownSelect(this)">Debug Tools</a>
-->
		</div>

	</div>


	<div class="Text-bar">
		<div id="simpleConfigText" class="no-click">
			<span>Simple Configuration</span>
		</div>
	</div>


	<div id="container1" class="rightContainer">

		<div class="horizLayout">
			<b> IO1 (BNC)</b> <div id="IO1Status" class="ioStatus none"></div>
			<br>
			Action:
			<div id="IO1Action" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (Do Nothing)</a>
				<a onclick="dropDownSelect(this)">Record End Trigger</a>
				<a onclick="dropDownSelect(this)">Exposure Trigger</a>
				<a onclick="dropDownSelect(this)">Shutter Gating</a>
				<a onclick="dropDownSelect(this)">Frame Sync. Output</a>
			</div></div>
			<br>
			Debounce:
			<a id="IO1Debounce" class="button" onclick="justRunSomething(this)">False</a>
			<br>
			Invert:
			<a id="IO1Invert" class="button" onclick="justRunSomething(this)">False</a>
			<br>
			Pull-up:
			<div id="IO1Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (off)</a>
				<a onclick="dropDownSelect(this)">1mA</a>
				<a onclick="dropDownSelect(this)">20mA</a>
			</div></div>
			<br>
			Threshold:
			<input id="IO1Threshold" type="number" min="0.0" max="5.0" step="0.1" oninput="changeNumberOften(this)">
		</div>

		<div class="horizLayout">
			<b> IO2</b> <div id="IO2Status" class="ioStatus none"></div>
			<br>
			Action:
			<div id="IO2Action" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (Do Nothing)</a>
				<a onclick="dropDownSelect(this)">Record End Trigger</a>
				<a onclick="dropDownSelect(this)">Exposure Trigger</a>
				<a onclick="dropDownSelect(this)">Shutter Gating</a>
				<a onclick="dropDownSelect(this)">Frame Sync. Output</a>
			</div></div>
			<br>
			Debounce:
			<a id="IO2Debounce" class="button" onclick="justRunSomething(this)">False</a>
			<br>
			Invert:
			<a id="IO2Invert" class="button" onclick="justRunSomething(this)">False</a>
			<br>
			Pull-up:
			<div id="IO2Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (off)</a>
				<a onclick="dropDownSelect(this)">20mA</a>
			</div></div>
			<br>
			Threshold:
			<input id="IO2Threshold" type="number" min="0.0" max="5.0" step="0.1" oninput="changeNumberOften(this)">
		</div>

		<div class="horizLayout">
			<b> Input 3 (Isolated)</b> <div id="IO3Status" class="ioStatus none"></div>
			<br>
			Action:
			<div id="IO3Action" class="selectContainerHolder" onclick="">None (Do Nothing)<div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (Do Nothing)</a>
				<a onclick="dropDownSelect(this)">Record End Trigger</a>
				<a onclick="dropDownSelect(this)">Exposure Trigger</a>
				<a onclick="dropDownSelect(this)">Shutter Gating</a>
			</div></div>
			<br>
			Debounce:
			<a id="IO3Debounce" class="button" onclick="justRunSomething(this)">False</a>
			<br>
			Invert:
			<a id="IO3Invert" class="button" onclick="justRunSomething(this)">False</a>
		</div>


		<div class="horizLayout">
			<b> Preset Configurations </b>
<!--
			<br>
			<span class="instruction">Select some common configurations</span>
-->
			<br>
			<div id="presetList" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">BNC Cable (Button) >> End Recording</a>
				<a onclick="dropDownSelect(this)">Reset All to Defaults</a>
			</div></div>
		</div>



	</div>

	<div id="batteryBar" class="Text-bar">
		<div id="battery" class="no-click">
			<div id="batteryContainer" class="battery">
				<div id="battery-level"></div>
			</div>
			<span id="battery%">0%</span>
		</div>

		<div id="legendContainer">
			<div class="no-click">
				Legend:
			</div>
			<div id="legendTrue" class="no-click">
				<div class="ioStatus true"></div>
				True/High/On
			</div>
			<div id="legendFalse" class="no-click">
				<div class="ioStatus false"></div>
				False/Low/Off
			</div>
		</div>
	</div>


	<div id="container2" class="rightContainer">

		<div class="Text-bar">
			<div id="advancedConfigText" class="no-click">
				<span>Advanced Configuration</span>
			</div>
		</div>



		<div id="ioMappingTriggerBox" class="horizLayout">
			<b> Trigger </b> <div id="ioMappingTriggerStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose what causes a 'Trigger' event </span>
			<br>
			Source:
			<div id="ioMappingTriggerSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingTriggerSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingTriggerDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingTriggerInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingStartRecBox" class="horizLayout">
			<b> Start Recording </b> <div id="ioMappingStartRecStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose what will start a recording </span>
			<br>
			Source:
			<div id="ioMappingStartRecSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingStartRecSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingStartRecDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingStartRecInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingStopRecBox" class="horizLayout">
			<b> Stop Recording </b> <div id="ioMappingStopRecStatus" class="ioStatus none"></div>
<!--			<div id="ioMappingStopRecOutput" class="ioStatus none"></div> -->
			<br>
			<span class="instruction"> Cause the recording to stop </span>
			<br>
			Source:
			<div id="ioMappingStopRecSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingStopRecSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingStopRecDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingStopRecInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingShutterBox" class="horizLayout">
			<b> Shutter </b> <div id="ioMappingShutterStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose what affects the shutter </span>
			<br>
			Source:
			<div id="ioMappingShutterSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingShutterSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingShutterDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingShutterInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingGateBox" class="horizLayout">
			<b> Gate </b> <div id="ioMappingGateStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Gate </span>
			<br>
			Source:
			<div id="ioMappingGateSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingGateSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingGateDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingGateInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleSetBox" class="horizLayout">
			<b> Toggle </b> <div id="ioMappingToggleSetStatus" class="ioStatus none"></div> <b> Set</b>
			<br>
			<span class="instruction"> Choose what will 'Set' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleSetSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingToggleSetSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingToggleSetDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleSetInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleFlipBox" class="horizLayout">
			<b> Toggle </b> <div id="ioMappingToggleFlipStatus" class="ioStatus none"></div> <b> Flip</b>
			<br>
			<span class="instruction"> Choose what will 'Flip' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleFlipSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingToggleFlipSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingToggleFlipDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleFlipInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleClearBox" class="horizLayout">
			<b> Toggle </b> <div id="ioMappingToggleClearStatus" class="ioStatus none"></div> <b> Clear</b>
			<br>
			<span class="instruction"> Choose what will 'Clear' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleClearSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingToggleClearSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingToggleClearDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleClearInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>



		<div id="ioMappingDelayBox" class="horizLayout">
			<b> Delay </b> <div id="ioMappingDelayStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose what causes the Delay Timer to run </span>
			<br>
			Source:
			<div id="ioMappingDelaySource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingDelaySourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingDelayDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingDelayInvert" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Time:
			<input id="ioMappingDelayTime" type="number" min="0.000" max="3600.000" step="0.001" oninput="changeNumberOften(this)">
		</div>


		<div id="ioMappingIo1Box" class="horizLayout">
			<b> Output 1 (IO1 out) </b> <div id="ioMappingIo1Status" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose when IO1 out does something </span>
			<br>
			Source:
			<div id="ioMappingIo1Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingIo1SourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingIo1Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingIo1Invert" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Drive Strength:
			<div id="ioMappingIo1Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">Off</a>
				<a onclick="dropDownSelect(this)">Low (1mA)</a>
				<a onclick="dropDownSelect(this)">High (20mA)</a>
			</div></div>
		</div>

		<div id="ioMappingIo2Box" class="horizLayout">
			<b> Output 2 (IO2 out) </b> <div id="ioMappingIo2Status" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose when IO2 out does something </span>
			<br>
			Source:
			<div id="ioMappingIo2Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingIo2SourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingIo2Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingIo2Invert" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Drive Strength:
			<div id="ioMappingIo2Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">Off</a>
				<a onclick="dropDownSelect(this)">High (20mA)</a>
			</div></div>
		</div>



<!--
		<div id="Box" class="horizLayout">
			<b> -- </b>
			<br>
			<span class="instruction"> Blank </span>
			<br>
			Source:
			<div id="Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="Debounce" class="button" onclick="sendIoRequest(this)">False</a>
			<br>
			Invert:
			<a id="Invert" class="button" onclick="sendIoRequest(this)">False</a>
		</div>


-->

	</div>


	<div id="combinatorialIconBox" class="horizLayout">
		<b> Combinatorial Block </b>
		<br>
		<br>
		Combinatorial OR1 <div id="combOr1Icon" class="ioStatus none"></div><br>
		Combinatorial OR2 <div id="combOr2Icon" class="ioStatus none"></div><br>
		Combinatorial OR3 <div id="combOr3Icon" class="ioStatus none"></div><br>
		<br>
		Combinatorial AND <div id="combAndIcon" class="ioStatus none"></div>&ensp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Combinatorial Out <div id="combOutIcon" class="ioStatus none"></div><br>
		<br>
		Combinatorial XOR <div id="combXorIcon" class="ioStatus none"></div>
		<div class="combBlock">
			<div class="linesIn"></div>
			<div class="orGateIcon"></div>
			<div class="andGateIcon"></div>
			<div class="xorGateIcon"></div>
			<div class="linesOut"></div>
		</div>
	</div>

	<div id="container3" class="rightContainer">

		<div id="ioMappingCombOr1Box" class="horizLayout">
			<b> Combinatorial OR 1 </b> <div id="ioMappingCombOr1Status" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Select a connection for the 1st combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr1Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingCombOr1SourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingCombOr1Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr1Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombOr2Box" class="horizLayout">
			<b> Combinatorial OR 2 </b> <div id="ioMappingCombOr2Status" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Select a connection for the 2nd combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr2Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingCombOr2SourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingCombOr2Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr2Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombOr3Box" class="horizLayout">
			<b> Combinatorial OR 3 </b> <div id="ioMappingCombOr3Status" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Select a connection for the 3rd combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr3Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingCombOr3SourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingCombOr3Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr3Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombXorBox" class="horizLayout">
			<b> Combinatorial XOR </b> <div id="ioMappingCombXorStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Select a connection for the combinatorial XOR input </span>
			<br>
			Source:
			<div id="ioMappingCombXorSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingCombXorSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingCombXorDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombXorInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombAndBox" class="horizLayout">
			<b> Combinatorial AND </b> <div id="ioMappingCombAndStatus" class="ioStatus none"></div>
			<br>
			<span class="instruction"> Choose what triggers the Combinatorial AND input </span>
			<br>
			Source:
			<div id="ioMappingCombAndSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<div id="ioMappingCombAndSourceStatus" class="ioStatus none ioInputStatus"></div>
			<br>
			Debounce:
			<a id="ioMappingCombAndDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombAndInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>




		<div id="inputStatusBox" class="horizLayout">
			<b> Input Status </b>
			<br>
			Always High (True): <div id="alwaysHighSourceStatus" class="ioStatus none"></div>
			<br>
			None (False): <div id="noneSourceStatus" class="ioStatus none"></div>
			<br>
			Input 1 (IO1): <div id="io1SourceStatus" class="ioStatus none"></div>
			<br>
			Input 2 (IO2): <div id="io2SourceStatus" class="ioStatus none"></div>
			<br>
			Input 3 (IO3): <div id="io3SourceStatus" class="ioStatus none"></div>
			<br>
			Delay Block: <div id="delaySourceStatus" class="ioStatus none"></div>
			<br>
			Next Segment: <div id="nextSegSourceStatus" class="ioStatus none"></div>
			<br>
			Timing IO: <div id="timingIoSourceStatus" class="ioStatus none"></div>
			<br>
			Display Frame: <div id="dispFrameSourceStatus" class="ioStatus none"></div>
			<br>
			Combinatorial Block: <div id="combSourceStatus" class="ioStatus none"></div>
			<br>
			Shutter: <div id="shutterSourceStatus" class="ioStatus none"></div>
			<br>
			Toggle Block: <div id="toggleSourceStatus" class="ioStatus none"></div>
			<br>
			End Recording: <div id="endRecSourceStatus" class="ioStatus none"></div>
			<br>
			Recording: <div id="recordingSourceStatus" class="ioStatus none"></div>
			<br>
			Start Recording: <div id="startRecSourceStatus" class="ioStatus none"></div>
			<br>
			Software Trigger: <div id="softwareSourceStatus" class="ioStatus none"></div>
		</div>

		<div id="outputStatusBox" class="horizLayout">
			<b> Output Status </b>
			<br>
			Gate: <div id="gateOutputStatus" class="ioStatus none"></div>
			<br>
			Delay: <div id="delayOutputStatus" class="ioStatus none"></div>
			<br>
			Start Recording: <div id="startOutputStatus" class="ioStatus none"></div>
			<br>
			Combinatorial Block: <div id="combOutputStatus" class="ioStatus none"></div>
			<br>
			Shutter: <div id="shutterOutputStatus" class="ioStatus none"></div>
			<br>
			Toggle Block: <div id="toggleOutputStatus" class="ioStatus none"></div>
			<br>
			Stop Recording: <div id="stopOutputStatus" class="ioStatus none"></div>
			<br>
			Output 1 (IO1): <div id="io1OutputStatus" class="ioStatus none"></div>
			<br>
			Output 2 (IO2): <div id="io2OutputStatus" class="ioStatus none"></div>
		</div>


	</div>


<!--
   "config": {

      "ioThresholdIo1": 2.49929,
      "ioThresholdIo2": 2.49929,

      "ioMappingCombOr2": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr3": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingStopRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingGate": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr1": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombXor": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleSet": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleFlip": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },


      "ioMappingStartRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingIo2": { --
         "source": "alwaysHigh",
         "drive": 0,
         "debounce": false,
         "invert": false
      },

      "ioMappingIo1": { --
         "source": "alwaysHigh",
         "drive": 1,
         "debounce": false,
         "invert": false
      },

      "ioMappingTrigger": { --
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "ioMappingDelay": { --
         "source": "comb",
         "debounce": false,
         "invert": false
      },


      "ioMappingToggleClear": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombAnd": { --
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "ioMappingShutter": {
         "source": "none",
         "debounce": false,
         "invert": false
      }

   },


   "ioSourceStatus": {
      "io3": false,
      "delay": false,
      "nextSeg": false,
      "timingIo": true,
      "dispFrame": false,
      "alwaysHigh": true,
      "comb": false,
      "none": false,
      "io1": true,
      "shutter": true,
      "toggle": true,
      "endRec": false,
      "recording": false,
      "software": false,
      "startRec": false,
      "io2": false
   },

   "ioOutputStatus": {
      "gate": false,
      "delay": false,
      "start": false,
      "comb": false,
      "shutter": false,
      "toggle": true,
      "stop": false,
      "io1": true,
      "io2": true

   },


   "ioMapping": {

      "combAnd": {
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "delay": {
         "source": "comb",
         "delayTime": 0,
         "debounce": false,
         "invert": false
      },

      "toggleSet": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "gate": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "toggleFlip": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "start": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "shutter": {
         "shutterTriggersFrame": false,
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr1": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr2": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr3": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combXOr": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "trigger": {
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "stop": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "toggleClear": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "io1In": {
         "threshold": 2.49929
      },

      "io2In": {
         "threshold": 2.49929
      },

      "io1": {
         "source": "alwaysHigh",
         "driveStrength": 1,
         "debounce": false,
         "invert": false
      },

      "io2": {
         "source": "alwaysHigh",
         "driveStrength": 0,
         "debounce": false,
         "invert": false
      }

   },


-->



	<div id="debugBar" class="Text-bar hidden">
		<a id="tester1" onclick="tester1func()"> tester1 </a>
		<a id="tester2" onclick="tester2func()"> tester2 </a>
		<a id="tester3" onclick="tester3func()"> tester3 </a>
		<a id="debugToggle" onclick="toggler(this)"> Display Messages </a>
		<div class="no-click"></div>
		<a onclick='theme("default")'> Default Theme </a>
		<a onclick='theme("monochrome")'> Mono Theme </a>
		<a onclick='theme("darker")'> Darker Theme </a>
		<a onclick='theme("lighter")'> Lighter Theme </a>
		<a onclick='theme("monoDark")'> Mono Dark </a>
		<a onclick='theme("newDefault")'> Light Theme2 </a>
	</div>
	<br>
	<span id="debugger">  </span>

	<span id="debugger2">  </span>
 </div>

<br>
<div class="matchBackground"> This page was made by Nicholas Faliszewski </div>


<div id="popUpBackground" class="popUpBackground hidden">
	<div id="messageWarn" class="popUpMessage">
		<div id="netShareResultBox" class="horizLayout hidden">
			Status of the network share requests
			<br>
			<a style="float: right;" class="button" onclick="dropDownSelect(this)">Ok</a>
		</div>
		<div id="somethingWeirdBox" class="horizLayout hidden">
			Something weird is happening
		</div>
	</div>
</div>

</body>

<script>

var DebugOnOff = false ;


function tester1func() {
//	dataRequester("set", '{"recPreBurst": ' + document.getElementById("preRecFrameNum").value + '}', pageUpdate) ;

}

function tester2func() {

//	dataGetter("p", "", pageUpdate) ; // get all the data

	dataRequester("set", '{"ioMappingIo1": {"source": "none", "debounce": false, "invert": false}}', pageUpdate) ;
}


function tester3func() {
	// clear recorded buffer
//	dataGetter("flushRecording", '', pageUpdate) ;

	dataRequester("set", '{"ioMappingIo1": {"source": "alwaysHigh", "debounce": True, "invert": True}}', pageUpdate) ;

}


function getCookie(cname) {
  var name = cname + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}







function setCookie (name, value) {
	var expiryDate = new Date() ;

	expiryDate.setTime(expiryDate.getTime() + 1000*60*60*24*90) ; // add 90 days (time is in ms)
//	expiryDate.setTime(expiryDate.getTime() + 1000*60*20) ; // add 20 minutes (time is in ms)

	document.cookie = name + "=" + value + "; expires=" + expiryDate.toUTCString() + "; path=/" ;
}


if (detectIE()) {
	if (DebugOnOff)
		document.getElementById("debugger2").innerHTML = "MS Browser detected" ;
	
	document.getElementById("windozeFixer").href = "css/windozeFixes.css" ;
	
	if ( (parseInt(detectIE()) <= 16) ) { // detect an older version (especially IE)
		if (DebugOnOff)
			document.getElementById("debugger2").innerHTML += " -- Seems to be Internet Explorer" ;
			
		var inputList = document.getElementsByTagName("input"); // get all 'input' types
		for (var i = 0 ; i < inputList.length ; i++) {
			if ( (inputList[i].type.toLowerCase() == "number") || (inputList[i].type.toLowerCase() == "text") )
				inputList[i].style.paddingBottom = "9px" ; // add some padding to the bottom of number or text inputs
		}
		
//		document.getElementById("postTriggerSlider").addEventListener('change', function() { changeNumberOften(document.getElementById("postTriggerSlider")) ; }) ;
	}
}



function detectIE() {
  var ua = window.navigator.userAgent;

  // Test values; Uncomment to check result â€¦

  // IE 10
  // ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)';
  
  // IE 11
  // ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko';
  
  // Edge 12 (Spartan)
  // ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0';
  
  // Edge 13
  // ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586';

  var msie = ua.indexOf('MSIE ');
  if (msie > 0) {
    // IE 10 or older => return version number
    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
  }

  var trident = ua.indexOf('Trident/');
  if (trident > 0) {
    // IE 11 => return version number
    var rv = ua.indexOf('rv:');
    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
  }

  var edge = ua.indexOf('Edge/');
  if (edge > 0) {
    // Edge (IE 12+) => return version number
    return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
  }

  // other browser
  return false;
}



function theme(selection) { // set a new stylesheet to use

	if ( (selection == "default") || (selection == "monochrome") || (selection == "darker") || (selection == "lighter") || (selection == "monoDark") || (selection == "newDefault") ) {
		document.getElementById("themeSelection").href = "/css/" + selection + "Theme.css" ;
	}
}



function boundInput(element) {
	if (parseInt(element.value) > parseInt(element.max))
		element.value = element.max ;
	else if (parseInt(element.value) < parseInt(element.min))
		element.value = element.min ;
}

function changeNumberOften(element) {
	if (typeof changeNumberOften.requestCount == 'undefined') // kind of like a static variable
		changeNumberOften.requestCount = 0 ;

	boundInput(element) ; // make sure the input number is not too high or too low

	var callWhenFinished = function(inputParams) { // set the callback / finished function
		pageUpdate(inputParams) ; // actually update the page
		changeNumberOften.requestCount -= 1 ; // allow another request
	}


	if ( (element.id == "IO1Threshold") && (changeNumberOften.requestCount < 1) ) {
		changeNumberOften.requestCount += 1 ;
		dataRequester("set", '{"ioThresholdIo1": ' + element.value + '}', callWhenFinished) ; // set IO1's threshold
	}
	else if ( (element.id == "IO2Threshold") && (changeNumberOften.requestCount < 1) ) {
		changeNumberOften.requestCount += 1 ;
		dataRequester("set", '{"ioThresholdIo2": ' + element.value + '}', callWhenFinished) ; // set IO2's threshold
	}
	else if ( (element.id == "ioMappingDelayTime") && (changeNumberOften.requestCount < 1) ) {
		changeNumberOften.requestCount += 1 ;
		dataRequester("set", '{"ioDelayTime": ' + element.value + '}', callWhenFinished) ; // set the Delay Block time
	}
}

function sendIoRequest (parent) {
	var sliceAmount = 0 ;
	switch (parent.id.slice(-5)) {
		case "Drive": // Drive
			sliceAmount = -5 ;
			break ;
		case "nvert": // Invert
			sliceAmount = -6 ;
			break ;
		case "ounce": // Debounce
			sliceAmount = -8 ;
			break ;
		case "ource": // Source
		default:
			sliceAmount = -6 ;
			break ;
	}

	var baseName = parent.id.slice(0, sliceAmount) ;

	var debounce = "false" ;
	if (document.getElementById(baseName + "Debounce").classList.contains("active"))
		debounce = "true" ;

	var invert = "false" ;
	if (document.getElementById(baseName + "Invert").classList.contains("active"))
		invert = "true" ;

	var source="" ;
	switch (document.getElementById(baseName + "Source").firstChild.textContent) {
		case "None (False)":
			source = "none" ;
			break ;
		case "Always High (True)":
			source = "alwaysHigh" ;
			break ;
		case "Input 1 (IO1 in)":
			source = "io1" ;
			break ;	
		case "Input 2 (IO2 in)":
			source = "io2" ;
			break ;
		case "Input 3 (IO3 in)":
			source = "io3" ;
			break ;
		case "Start of Recording":
			source = "startRec" ;
			break ;
		case "End of Recording":
			source = "endRec" ;
			break ;
		case "While Recording":
			source = "recording" ;
			break ;
		case "Timing IO":
			source = "timingIo" ;
			break ;
		case "Delay Block":
			source = "delay" ;
			break ;
		case "Software Trigger":
			source = "software" ;
			break ;
		case "Toggle Block":
			source = "toggle" ;
			break ;
		case "Combinatorial Block":
			source = "comb" ;
			break ;
		case "Shutter":
			source = "shutter" ;
			break ;
		case "Next Segment":
			source = "nextSeg" ;
			break ;
		case "Display Frame":
			source = "dispFrame" ;
			break ;
	}

	var request = '{"' + baseName + '": {"source": "' + source + '", "debounce": ' + debounce + ', "invert": ' + invert ;

	if ( (baseName == "ioMappingIo1") || (baseName == "ioMappingIo2") ) {
		request += ', "drive": ' ;
		switch (document.getElementById(baseName + "Drive").firstChild.textContent) {
			case "Low (1mA)":
				request += "1" ;
				break ;
			case "High (20mA)":
				request += "2" ;
				break ;
			default:
				request += "0" ;
		}
	}

	request += '}}' ;

	dataRequester("set", request, pageUpdate) ; // send the request
}

function simpleModeWrite() {
	// get the 'action' of each port
	var io1Action = document.getElementById("IO1Action").firstChild.textContent ;
	var io2Action = document.getElementById("IO2Action").firstChild.textContent ;
	var io3Action = document.getElementById("IO3Action").firstChild.textContent ;

	var preRequest = '{ "ioMappingCombOr1": { "source": "none", "debounce": false, "invert": false}, "ioMappingCombOr2": { "source": "none", "debounce": false, "invert": false}, "ioMappingCombOr3": { "source": "none", "debounce": false, "invert": false}, "ioMappingCombAnd": {"source": "alwaysHigh", "debounce": false, "invert": false}, "ioMappingCombXor": {"source": "none", "debounce": false, "invert": false} }' ;

	dataRequester('set', preRequest, pageUpdate) ;

	var request = "{" ;

	switch (io1Action) {
		case "None (Do Nothing)":
			request += '"ioMappingIo1": {"source": "alwaysHigh", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() ;
			request += ', "drive": ' + ((document.getElementById("IO1Drive").firstChild.textContent == "1mA") ? 1 : (document.getElementById("IO1Drive").firstChild.textContent == "20mA") ? 2 : 0) + "}" ;
			request += ', "ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false}' ;
			break ;

		case "Record End Trigger":
			if ( (io2Action == "Record End Trigger") || (io3Action == "Record End Trigger") ) {
				request += '"ioMappingIo1": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO1Drive").firstChild.textContent == "1mA") ? 1 : (document.getElementById("IO1Drive").firstChild.textContent == "20mA") ? 2 : 0) + "}" ;
				request += ', "ioMappingCombOr1": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingTrigger": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += '"ioMappingTrigger": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
			break ;

		case "Exposure Trigger":
			if ( (io2Action == "Exposure Trigger") || (io3Action == "Exposure Trigger") ) {
				request += '"ioMappingIo1": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO1Drive").firstChild.textContent == "1mA") ? 1 : (document.getElementById("IO1Drive").firstChild.textContent == "20mA") ? 2 : 0) + "}" ;
				request += ', "ioMappingCombOr1": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingShutter": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += '"ioMappingShutter": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "frameTrigger"' ;
			break ;

		case "Shutter Gating":
			if ( (io2Action == "Exposure Trigger") || (io3Action == "Exposure Trigger") ) {
				request += '"ioMappingIo1": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO1Drive").firstChild.textContent == "1mA") ? 1 : (document.getElementById("IO1Drive").firstChild.textContent == "20mA") ? 2 : 0) + "}" ;
				request += ', "ioMappingCombOr1": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingShutter": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += '"ioMappingShutter": {"source": "io1", "debounce": ' + document.getElementById("IO1Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "shutterGating"' ;
			break ;

		case "Frame Sync. Output":
			request += '"ioMappingIo1": {"source": "timingIo", "debounce": false, "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
			request += ', "ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false}' ;
			break ;
	}


//	request += '}' ;
//	dataRequester("set", request, pageUpdate) ; // split this up because otherwise the request gets way too long

//	request = '{' ; // reset the request


	switch (io2Action) {
		case "None (Do Nothing)":
			request += ', "ioMappingIo2": {"source": "alwaysHigh", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() ;
			request += ', "drive": ' + ((document.getElementById("IO2Drive").firstChild.textContent == "20mA") ? 1 : 0) + "}" ;
			request += ', "ioMappingCombOr2": {"source": "none", "debounce": false, "invert": false}' ;
			break ;

		case "Record End Trigger":
			if ( (io1Action == "Record End Trigger") || (io3Action == "Record End Trigger") ) {
				request += ', "ioMappingIo2": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO2Drive").firstChild.textContent == "20mA") ? 1 : 0) + "}" ;
				request += ', "ioMappingCombOr2": {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			}
			else
				request += '"ioMappingTrigger": {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			break ;

		case "Exposure Trigger":
			if ( (io1Action == "Exposure Trigger") || (io3Action == "Exposure Trigger") ) {
				request += ', "ioMappingIo2": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO2Drive").firstChild.textContent == "20mA") ? 1 : 0) + "}" ;
				request += ', "ioMappingCombOr2": {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			}
			else
				request += ', "ioMappingShutter": {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "frameTrigger"' ;
			break ;

		case "Shutter Gating":
			if ( (io1Action == "Exposure Trigger") || (io3Action == "Exposure Trigger") ) {
				request += ', "ioMappingIo2": {"source": "alwaysHigh", "debounce": false, "invert": false, "drive": ' + ((document.getElementById("IO2Drive").firstChild.textContent == "20mA") ? 1 : 0) + "}" ;
				request += ', "ioMappingCombOr2", {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			}
			else
				request += ', "ioMappingShutter": {"source": "io2", "debounce": ' + document.getElementById("IO2Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "shutterGating"' ;
			break ;

		case "Frame Sync. Output":
			request += ', "ioMappingIo2": {"source": "timingIo", "debounce": false, "invert": ' + document.getElementById("IO2Invert").textContent.toLowerCase() + '}' ;
			request += ', "ioMappingCombOr2": {"source": "none", "debounce": false, "invert": false}' ;
			break ;
	}

//	request += '}' ;
//	dataRequester("set", request, pageUpdate) ; // split this up because otherwise the request gets way too long

//	request = '{' ; // reset the request


	switch (io3Action) {
		case "None (Do Nothing)":
			request += ', "ioMappingCombOr3": {"source": "none", "debounce": false, "invert": false}' ;
			break ;

		case "Record End Trigger":
			if ( (io1Action == "Record End Trigger") || (io2Action == "Record End Trigger") ) {
				request += ', "ioMappingCombOr3": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO3Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingTrigger": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += ', "ioMappingTrigger": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO3Invert").textContent.toLowerCase() + '}' ;
			break ;

		case "Exposure Trigger":
			if ( (io1Action == "Exposure Trigger") || (io2Action == "Exposure Trigger") ) {
				request += ', "ioMappingCombOr3": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO3Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingShutter": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += '"ioMappingShutter": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO1Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "frameTrigger"' ;
			break ;

		case "Shutter Gating":
			if ( (io1Action == "Exposure Trigger") || (io2Action == "Exposure Trigger") ) {
				request += ', "ioMappingCombOr3": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO3Invert").textContent.toLowerCase() + '}' ;
				request += ', "ioMappingShutter": {"source": "comb", "debounce": false, "invert": false"}' ;
			}
			else
				request += ', "ioMappingShutter": {"source": "io3", "debounce": ' + document.getElementById("IO3Debounce").textContent.toLowerCase() + ', "invert": ' + document.getElementById("IO3Invert").textContent.toLowerCase() + '}' ;
			request += ', "exposureMode": "shutterGating"' ;
			break ;
	}

	request += '}' ;

	document.getElementById("debugger2").innerHTML += "<br><br>" + "This is the \"simple mode\" request: " + request ;

	dataRequester ("set", request, pageUpdate) ;
}

function debounceOrInvert(element) { // similar to toggle function, but specific to ioMapping* objects
	var leftRight = 0 ;

	if (element.classList.contains("active")) { // changing to 'inactive' or no state set previously
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
		element.innerHTML = "False" ;
	}
	else if (element.classList.contains("disabled")) { // button disabled
		return ; // don't do anything
	}
	else {
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
		element.innerHTML = "True" ;
	}

	sendIoRequest(element) ; // make and send a request for an IO change
}


var dropDownFunctions = { "Debug Tools":	function(){ var item = document.getElementById("debugBar") ; if (item.classList.contains("hidden")) { item.classList.remove("hidden") ; } else { item.classList.add("hidden") ; } },

				"None (Do Nothing)":	function(parent) { parent.firstChild.textContent = "None (Do Nothing)" ; simpleModeWrite() ; },
				"Record End Trigger":	function(parent) { parent.firstChild.textContent = "Record End Trigger" ; simpleModeWrite() ; },
				"Exposure Trigger":		function(parent) { parent.firstChild.textContent = "Exposure Trigger" ; simpleModeWrite() ; },
				"Shutter Gating":		function(parent) { parent.firstChild.textContent = "Shutter Gating" ; simpleModeWrite() ; },
				"Frame Sync. Output":	function(parent) { parent.firstChild.textContent = "Frame Sync. Output" ; simpleModeWrite() ; },

				"None (off)":			function(parent) { parent.firstChild.textContent = "None (off)" ; simpleModeWrite() ; },
				"1mA":					function(parent) { parent.firstChild.textContent = "1mA" ; simpleModeWrite() ; },
				"20mA":					function(parent) { parent.firstChild.textContent = "20mA" ; simpleModeWrite() ; },

				"None (False)":			function(parent) { parent.firstChild.textContent = "None (False)" ; sendIoRequest(parent) ; },
				"Always High (True)":	function(parent) { parent.firstChild.textContent = "Always High (True)" ; sendIoRequest(parent) ; },
				"Input 1 (IO1 in)":		function(parent) { parent.firstChild.textContent = "Input 1 (IO1 in)" ; sendIoRequest(parent) ; },
				"Input 2 (IO2 in)":		function(parent) { parent.firstChild.textContent = "Input 2 (IO2 in)" ; sendIoRequest(parent) ; },
				"Input 3 (IO3 in)":		function(parent) { parent.firstChild.textContent = "Input 3 (IO3 in)" ; sendIoRequest(parent) ; },
				"Start of Recording":	function(parent) { parent.firstChild.textContent = "Start of Recording" ; sendIoRequest(parent) ; },
				"End of Recording":		function(parent) { parent.firstChild.textContent = "End of Recording" ; sendIoRequest(parent) ; },
				"While Recording":		function(parent) { parent.firstChild.textContent = "While Recording" ; sendIoRequest(parent) ; },
				"Timing IO":			function(parent) { parent.firstChild.textContent = "Timing IO" ; sendIoRequest(parent) ; },
				"Delay Block":			function(parent) { parent.firstChild.textContent = "Delay Block" ; sendIoRequest(parent) ; },
				"Software Trigger":		function(parent) { parent.firstChild.textContent = "Software Trigger" ; sendIoRequest(parent) ; },
				"Toggle Block":			function(parent) { parent.firstChild.textContent = "Toggle Block" ; sendIoRequest(parent) ; },
				"Combinatorial Block":	function(parent) { parent.firstChild.textContent = "Combinatorial Block" ; sendIoRequest(parent) ; },
				"Shutter":				function(parent) { parent.firstChild.textContent = "Shutter" ; sendIoRequest(parent) ; },
				"Next Segment":			function(parent) { parent.firstChild.textContent = "Next Segment" ; sendIoRequest(parent) ; },
				"Display Frame":		function(parent) { parent.firstChild.textContent = "Display Frame" ; sendIoRequest(parent) ; },

				"Off":					function(parent) { parent.firstChild.textContent = "Off" ; sendIoRequest(parent) ; },
				"Low (1mA)":			function(parent) { parent.firstChild.textContent = "Low (1mA)" ; sendIoRequest(parent) ; },
				"High (20mA)":			function(parent) { parent.firstChild.textContent = "High (20mA)" ; sendIoRequest(parent) ; },

				"Ok":					function() { document.getElementById("popUpBackground").classList.add("hidden") ; document.getElementById("netShareResultBox").classList.add("hidden") ;  dataGetter('get', 'externalStorage', pageUpdate) ; },

				"BNC Cable (Button) >> End Recording": function() { document.getElementById("presetList").firstChild.textContent = "BNC Cable (Button) >> End Recording" ; dataRequester('set', '{ "ioMappingCombOr3": {"source": "none", "debounce": false, "invert": false}, "ioMappingStopRec": {"source": "none", "debounce": false, "invert": false}, "ioMappingGate": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombXor": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleSet": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleFlip": {"source": "none", "debounce": false, "invert": false}, "ioMappingStartRec": {"source": "none", "debounce": false, "invert": false}, "ioMappingIo2": {"source": "alwaysHigh", "drive": 0, "debounce": false, "invert": false}, "ioMappingIo1": {"source": "alwaysHigh", "drive": 2, "debounce": false, "invert": false}, "ioMappingTrigger": {"source": "io1", "debounce": true, "invert": true}, "ioMappingDelay": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleClear": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombAnd": {"source": "none", "debounce": false, "invert": false}, "ioMappingShutter": {"source": "none", "debounce": false, "invert": false}, "ioThresholdIo1": 2.5, "ioThresholdIo2": 2.5, "ioDelayTime": 0.0 }', pageUpdate) ; },
				"Reset All to Defaults": function() { document.getElementById("presetList").firstChild.textContent = "Reset All to Defaults" ; dataRequester('set', '{ "ioMappingCombOr3": {"source": "none", "debounce": false, "invert": false}, "ioMappingStopRec": {"source": "none", "debounce": false, "invert": false}, "ioMappingGate": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombOr2": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombXor": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleSet": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleFlip": {"source": "none", "debounce": false, "invert": false}, "ioMappingStartRec": {"source": "none", "debounce": false, "invert": false}, "ioMappingIo2": {"source": "none", "drive": 0, "debounce": false, "invert": false}, "ioMappingIo1": {"source": "none", "drive": 0, "debounce": false, "invert": false}, "ioMappingTrigger": {"source": "none", "debounce": false, "invert": false}, "ioMappingDelay": {"source": "none", "debounce": false, "invert": false}, "ioMappingToggleClear": {"source": "none", "debounce": false, "invert": false}, "ioMappingCombAnd": {"source": "none", "debounce": false, "invert": false}, "ioMappingShutter": {"source": "none", "debounce": false, "invert": false}, "ioThresholdIo1": 2.5, "ioThresholdIo2": 2.5, "ioDelayTime": 0.0 }', pageUpdate) },

						}


/*
'{
	"ioMappingCombOr3": {"source": "none", "debounce": false, "invert": false},
	"ioMappingStopRec": {"source": "none", "debounce": false, "invert": false},
	"ioMappingGate": {"source": "none", "debounce": false, "invert": false},
	"ioMappingCombOr1": {"source": "none", "debounce": false, "invert": false},
	"ioMappingCombXor": {"source": "none", "debounce": false, "invert": false},
	"ioMappingToggleSet": {"source": "none", "debounce": false, "invert": false},
	"ioMappingToggleFlip": {"source": "none", "debounce": false, "invert": false},
	"ioMappingStartRec": {"source": "none", "debounce": false, "invert": false},
	"ioMappingIo2": {"source": "alwaysHigh", "drive": 0, "debounce": false, "invert": false},
	"ioMappingIo1": {"source": "alwaysHigh", "drive": 0, "debounce": false, "invert": false},
	"ioMappingTrigger": {"source": "none", "debounce": false, "invert": false},
	"ioMappingDelay": {"source": "none", "debounce": false, "invert": false},
	"ioMappingToggleClear": {"source": "none", "debounce": false, "invert": false},
	"ioMappingCombAnd": {"source": "none", "debounce": false, "invert": false},
	"ioMappingShutter": {"source": "none", "debounce": false, "invert": false},
	"ioThresholdIo1": 2.5,
	"ioThresholdIo2": 2.5,
	"ioDelayTime": 0.0
}'
*/

function dropDownSelect (element) {
	if (element.innerText in dropDownFunctions) // if the key-value exists
		dropDownFunctions[element.innerText](element.parentElement.parentElement) ; // run the function
}



var inputFunctions = { "IO1Debounce":			function() { document.getElementById("IO1Debounce").innerHTML = ((document.getElementById("IO1Debounce").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
				"IO1Invert":			function() { document.getElementById("IO1Invert").innerHTML = ((document.getElementById("IO1Invert").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
				"IO2Debounce":			function() { document.getElementById("IO2Debounce").innerHTML = ((document.getElementById("IO2Debounce").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
				"IO2Invert":			function() { document.getElementById("IO2Invert").innerHTML = ((document.getElementById("IO2Invert").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
				"IO3Debounce":			function() { document.getElementById("IO3Debounce").innerHTML = ((document.getElementById("IO3Debounce").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
				"IO3Invert":			function() { document.getElementById("IO3Invert").innerHTML = ((document.getElementById("IO3Invert").innerHTML == "False") ? "True" : "False") ; simpleModeWrite() ; },
					 }


function justRunSomething(element) {
	if (element.id in inputFunctions) // if the key-value exists
		inputFunctions[element.id](element.value) ; // run the function (with the value given)
}



document.getElementById("menu").onmouseenter = function(){ document.getElementById("menuList").style.display = "block" ; }
document.getElementById("menu").onmouseleave = function() {
	var otherMenu = document.getElementById("menuList") ;
	setTimeout( function() {
		if (!document.getElementById("menu").classList.contains("active"))
			document.getElementById("menuList").style.display = "" ;
	}, 50) ;
}


window.onclick = function(event) { // check where a click was: if it was outside a menu, close that menu
	if ( !event.target.matches(".menuClickOk") && (event.target.parent == undefined || !event.target.parent.matches(".menuClickOk"))
	&& (document.getElementById("menu").matches(".active")) ) {
		toggler(document.getElementById("menu")) ; // toggle off the button (and close the menu)
	}
}



var nameChange = {
					"ioMappingStopRecDebounce":		[ "False", "True"],
					"ioMappingStopRecInvert":		[ "False", "True"],
					"ioMappingCombOr1Debounce":		[ "False", "True"],
					"ioMappingCombOr1Invert":		[ "False", "True"],
					"ioMappingCombOr2Debounce":		[ "False", "True"],
					"ioMappingCombOr2Invert":		[ "False", "True"],
					"ioMappingCombOr3Debounce":		[ "False", "True"],
					"ioMappingCombOr3Invert":		[ "False", "True"],
					"ioMappingCombXorDebounce":		[ "False", "True"],
					"ioMappingCombXorInvert":		[ "False", "True"],
					"ioMappingCombAndDebounce":		[ "False", "True"],
					"ioMappingCombAndInvert":		[ "False", "True"],
					"ioMappingGateDebounce":		[ "False", "True"],
					"ioMappingGateInvert":			[ "False", "True"],
					"ioMappingToggleSetDebounce":	[ "False", "True"],
					"ioMappingToggleSetInvert":		[ "False", "True"],
					"ioMappingToggleFlipDebounce":	[ "False", "True"],
					"ioMappingToggleFlipInvert":	[ "False", "True"],
					"ioMappingToggleClearDebounce":	[ "False", "True"],
					"ioMappingToggleClearInvert":	[ "False", "True"],
					"ioMappingStartRecDebounce":	[ "False", "True"],
					"ioMappingStartRecInvert":		[ "False", "True"],
					"ioMappingIo1Debounce":			[ "False", "True"],
					"ioMappingIo1Invert":			[ "False", "True"],
					"ioMappingIo2Debounce":			[ "False", "True"],
					"ioMappingIo2Invert":			[ "False", "True"],
					"ioMappingTriggerDebounce":		[ "False", "True"],
					"ioMappingTriggerInvert":		[ "False", "True"],
					"ioMappingDelayDebounce":		[ "False", "True"],
					"ioMappingDelayInvert":			[ "False", "True"],
					"ioMappingShutterDebounce":		[ "False", "True"],
					"ioMappingShutterInvert":		[ "False", "True"],
				}

var buttonFunctions = {	"menu":			[ function(){ document.getElementById("menuList").style.display = "" ; }, function(){ menuKeeper() ; document.getElementById("menuList").style.display = "block" ;} ],					

						"debugToggle":			[ function(){ DebugOnOff = false ; document.getElementById("debugger").innerHTML = "" ; document.getElementById("debugger2").innerHTML = "" ; }, function() { DebugOnOff = true ; } ],
						"displayToggleButton":	[ function(){ dataRequester("set", '{"backlightEnabled": false}', pageUpdate) ; }, function(){ dataRequester("set", '{"backlightEnabled": true}', pageUpdate) ; } ],
						"autoSaveButton":		[ function(){ if (getCookie("as") > 0) { setCookie("as", parseInt(getCookie("as") * -1)) ; } else { setCookie("as", 0) ; } }, function() { if (getCookie("as") < 0) { setCookie("as", parseInt(getCookie("as") * -1)) ; } else { setCookie("as", 1) ; } } ],

						"disableRBButton":		[ function(){ dataSender("set", '{"disableRingBuffer": 0}') ; }, function() { dataSender("set", '{"disableRingBuffer": 1}') ; } ],
						"smbPassShowHide":		[ function(){ document.getElementById("smbPass").type="password" ; document.getElementById("smbPass").placeholder="******" ; }, function(){ document.getElementById("smbPass").type="text" ; document.getElementById("smbPass").placeholder="s3cr3t" ; } ],

					  }


function toggler(element) { // toggle the class (active/inactive), change the name, and run a function for a toggle button/switch
	var leftRight = 0 ;

	if (element.classList.contains("active")) { // changing to 'inactive' or no state set previously
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
		leftRight = 0 ; // use the 'left' column for names / functions
	}
	else if (element.classList.contains("disabled")) { // button disabled
		return ; // don't do anything
	}
	else {
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
		leftRight = 1 ; // use the 'right' column for names / functions
	}

	if (element.id in nameChange) // check if key-value exists
		element.innerHTML = nameChange[element.id][leftRight] ; // set name to the left (inactive) or right (active) one

	if (element.id in buttonFunctions) // if the key-value exists
		buttonFunctions[element.id][leftRight](element) ; // run the left (inactive) or right (active) function
}

function stateSelecter(element, state) { // this is like toggler above, but doesn't run the function ; set the class (active/inactive), change the name

	if (state) { // switch to active
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
	}
	else { // switch to inactive
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
	}

	state *= 1 ;

	if (element.id in nameChange) // check if key-value exists
		element.innerHTML = nameChange[element.id][state] ; // set name to the left (inactive) or right (active) one
}


function menuKeeper() {
	document.getElementById("menu").classList.remove("inactive");
	document.getElementById("menu").classList.add("active");
}


function batteryPercent(level, charging) { // set the percentage (level) of the battery (and whether it's charging)
	var indicator = document.getElementById("battery-level") ;
	var text = document.getElementById("battery%") ;

	if (level <= 100 && level >= 0) { // not charging (and level is ok)
		text.innerHTML = level.toString() + "%" ;


		if (charging) {
			indicator.style.height = "100%" ; // just make the level full when charging
			indicator.style.backgroundColor = "white" ; // white background while charging
			indicator.innerHTML = '<div id="chargeIcon" class="hidden"></div>' ; // add the charging indicator
		}
		else {
			indicator.style.height = level.toString() + "%" ;
			indicator.innerHTML = '' ; // clear the charging icon

			if (level <= 20)
				indicator.style.backgroundColor = "#a00" ; // red (low)
			else if (level <= 55)
				indicator.style.backgroundColor = "#e7ba00" ; // yellow (less than half)
			else
				indicator.style.backgroundColor = "green" ; // green (fine / more than half)
		}
	}
}


function driveName(value) {
	switch (value) {
		case 1:
			return "Low (1mA)" ;
		case 2:
			return "High (20mA)" ;
		case 0:
			return "Off" ;

		default:
			return "Unkown (" + value + ")" ;
	}
}

function sourceName(source) {
	switch (source) {
		case "none":
			return "None (False)" ;
		case "alwaysHigh":
			return "Always High (True)" ;
		case "io1":
			return "Input 1 (IO1 in)" ;
		case "io2":
			return "Input 2 (IO2 in)" ;
		case "io3":
			return "Input 3 (IO3 in)" ;
		case "startRec":
			return "Start of Recording" ;
		case "endRec":
			return "End of Recording" ;
		case "recording":
			return "While Recording" ;
		case "timingIo":
			return "Timing IO" ;
		case "delay":
			return "Delay Block" ;
		case "software":
			return "Software Trigger" ;
		case "toggle":
			return "Toggle Block" ;
		case "comb":
			return "Combinatorial Block" ;
		case "shutter":
			return "Shutter" ;
		case "nextSeg":
			return "Next Segment" ;
		case "dispFrame":
			return "Display Frame" ;

		default:
			return "Unknown" ;
	}
}


var lastKnownExposureMode = "" ;
var lastKnownBatteryLevel = 0 ;
var lastKnownExternalPower = false ;

function pageUpdate(rawData){
	var parsedData = JSON.parse(rawData) ;

	if (DebugOnOff)
		document.getElementById("debugger").innerHTML += "<br><br>got info:" + rawData ;

	if ("batteryChargePercent" in parsedData) {
		lastKnownBatteryLevel = Math.round(parsedData.batteryChargePercent) ; // set the last known battery percent value
		batteryPercent(lastKnownBatteryLevel, lastKnownExternalPower) ; // update the battery indicator
	}

	if ("externalPower" in parsedData) {
		lastKnownExternalPower = parsedData.externalPower ; // set the last known power connection
		batteryPercent(lastKnownBatteryLevel, lastKnownExternalPower) ; // update the battery indicator
	}

	if ("exposureMode" in parsedData)
		lastKnownExposureMode = parsedData.exposureMode ;

	if ("ioSourceStatus" in parsedData) { // these are all the 'inputs' that can be selected


		document.getElementById("IO1Status").classList.replace(document.getElementById("IO1Status").classList[1], parsedData.ioSourceStatus.io1) ;
		document.getElementById("IO2Status").classList.replace(document.getElementById("IO2Status").classList[1], parsedData.ioSourceStatus.io2) ;
		document.getElementById("IO3Status").classList.replace(document.getElementById("IO3Status").classList[1], parsedData.ioSourceStatus.io3) ;

		document.getElementById("ioMappingTriggerStatus").classList.replace(document.getElementById("ioMappingTriggerStatus").classList[1], parsedData.ioSourceStatus.software) ;

		document.getElementById("alwaysHighSourceStatus").classList.replace(document.getElementById("alwaysHighSourceStatus").classList[1], parsedData.ioSourceStatus.alwaysHigh) ;
		document.getElementById("noneSourceStatus").classList.replace(document.getElementById("noneSourceStatus").classList[1], parsedData.ioSourceStatus.none) ;
		document.getElementById("io1SourceStatus").classList.replace(document.getElementById("io1SourceStatus").classList[1], parsedData.ioSourceStatus.io1) ;
		document.getElementById("io2SourceStatus").classList.replace(document.getElementById("io2SourceStatus").classList[1], parsedData.ioSourceStatus.io2) ;
		document.getElementById("io3SourceStatus").classList.replace(document.getElementById("io3SourceStatus").classList[1], parsedData.ioSourceStatus.io3) ;

		document.getElementById("delaySourceStatus").classList.replace(document.getElementById("delaySourceStatus").classList[1], parsedData.ioSourceStatus.delay) ;
		document.getElementById("nextSegSourceStatus").classList.replace(document.getElementById("nextSegSourceStatus").classList[1], parsedData.ioSourceStatus.nextSeg) ;
		document.getElementById("timingIoSourceStatus").classList.replace(document.getElementById("timingIoSourceStatus").classList[1], parsedData.ioSourceStatus.timingIo) ;
		document.getElementById("dispFrameSourceStatus").classList.replace(document.getElementById("dispFrameSourceStatus").classList[1], parsedData.ioSourceStatus.dispFrame) ;
		document.getElementById("combSourceStatus").classList.replace(document.getElementById("combSourceStatus").classList[1], parsedData.ioSourceStatus.comb) ;
		document.getElementById("shutterSourceStatus").classList.replace(document.getElementById("shutterSourceStatus").classList[1], parsedData.ioSourceStatus.shutter) ;
		document.getElementById("toggleSourceStatus").classList.replace(document.getElementById("toggleSourceStatus").classList[1], parsedData.ioSourceStatus.toggle) ;

		document.getElementById("endRecSourceStatus").classList.replace(document.getElementById("endRecSourceStatus").classList[1], parsedData.ioSourceStatus.endRec) ;
		document.getElementById("recordingSourceStatus").classList.replace(document.getElementById("recordingSourceStatus").classList[1], parsedData.ioSourceStatus.recording) ;
		document.getElementById("startRecSourceStatus").classList.replace(document.getElementById("startRecSourceStatus").classList[1], parsedData.ioSourceStatus.software) ;
		document.getElementById("softwareSourceStatus").classList.replace(document.getElementById("softwareSourceStatus").classList[1], parsedData.ioSourceStatus.startRec) ;

//      "alwaysHigh": true,
//      "none": false,
//      "io1": true,
//      "io2": false
//      "io3": false,

//      "delay": false,
//      "nextSeg": false,
//      "timingIo": true,
//      "dispFrame": false,

//      "comb": false,
//      "shutter": true,
//      "toggle": true,
//      "endRec": false,
//      "recording": false,
//      "software": false,
//      "startRec": false,

		var allInputs = document.getElementsByClassName("ioInputStatus") ;

		for (var i = 0 ; i < allInputs.length; i++) {
			switch (allInputs[i].previousElementSibling.firstChild.textContent) {
				case "None (False)":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.none) ;
					break ;
				case "Always High (True)":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.alwaysHigh) ;
					break ;
				case "Input 1 (IO1 in)":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.io1) ;
					break ;	
				case "Input 2 (IO2 in)":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.io2) ;
					break ;
				case "Input 3 (IO3 in)":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.io3) ;
					break ;
				case "Start of Recording":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.startRec) ;
					break ;
				case "End of Recording":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.endRec) ;
					break ;
				case "While Recording":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.recording) ;
					break ;
				case "Timing IO":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.timingIo) ;
					break ;
				case "Delay Block":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.delay) ;
					break ;
				case "Software Trigger":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.software) ;
					break ;
				case "Toggle Block":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.toggle) ;
					break ;
				case "Combinatorial Block":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.comb) ;
					break ;
				case "Shutter":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.shutter) ;
					break ;
				case "Next Segment":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.nextSeg) ;
					break ;
				case "Display Frame":
					allInputs[i].classList.replace(allInputs[i].classList[1], parsedData.ioSourceStatus.dispFrame) ;
					break ;
			}
		}

	}

	if ("ioOutputStatus" in parsedData) { // these are all the 'outputs' which are reported back
//      "gate": false,
//      "delay": false,
//      "start": false,
//      "comb": false,
//      "shutter": false,
//      "toggle": true,
//      "stop": false,
//      "io1": true,
//      "io2": true

		document.getElementById("ioMappingStopRecStatus").classList.replace(document.getElementById("ioMappingStopRecStatus").classList[1], parsedData.ioOutputStatus.stop) ;
		document.getElementById("ioMappingGateStatus").classList.replace(document.getElementById("ioMappingGateStatus").classList[1], parsedData.ioOutputStatus.gate) ;

		document.getElementById("ioMappingToggleSetStatus").classList.replace(document.getElementById("ioMappingToggleSetStatus").classList[1], parsedData.ioOutputStatus.toggle) ;
		document.getElementById("ioMappingToggleFlipStatus").classList.replace(document.getElementById("ioMappingToggleFlipStatus").classList[1], parsedData.ioOutputStatus.toggle) ;
		document.getElementById("ioMappingToggleClearStatus").classList.replace(document.getElementById("ioMappingToggleClearStatus").classList[1], parsedData.ioOutputStatus.toggle) ;

		document.getElementById("ioMappingStartRecStatus").classList.replace(document.getElementById("ioMappingStartRecStatus").classList[1], parsedData.ioOutputStatus.start) ;
		document.getElementById("ioMappingIo1Status").classList.replace(document.getElementById("ioMappingIo1Status").classList[1], parsedData.ioOutputStatus.io1) ;
		document.getElementById("ioMappingIo2Status").classList.replace(document.getElementById("ioMappingIo2Status").classList[1], parsedData.ioOutputStatus.io2) ;
		document.getElementById("ioMappingDelayStatus").classList.replace(document.getElementById("ioMappingDelayStatus").classList[1], parsedData.ioOutputStatus.delay) ;
		document.getElementById("ioMappingShutterStatus").classList.replace(document.getElementById("ioMappingShutterStatus").classList[1], parsedData.ioOutputStatus.shutter) ;


		document.getElementById("gateOutputStatus").classList.replace(document.getElementById("gateOutputStatus").classList[1], parsedData.ioOutputStatus.gate) ;
		document.getElementById("delayOutputStatus").classList.replace(document.getElementById("delayOutputStatus").classList[1], parsedData.ioOutputStatus.delay) ;
		document.getElementById("startOutputStatus").classList.replace(document.getElementById("startOutputStatus").classList[1], parsedData.ioOutputStatus.start) ;
		document.getElementById("combOutputStatus").classList.replace(document.getElementById("combOutputStatus").classList[1], parsedData.ioOutputStatus.comb) ;
		document.getElementById("shutterOutputStatus").classList.replace(document.getElementById("shutterOutputStatus").classList[1], parsedData.ioOutputStatus.shutter) ;
		document.getElementById("toggleOutputStatus").classList.replace(document.getElementById("toggleOutputStatus").classList[1], parsedData.ioOutputStatus.toggle) ;
		document.getElementById("stopOutputStatus").classList.replace(document.getElementById("stopOutputStatus").classList[1], parsedData.ioOutputStatus.stop) ;
		document.getElementById("io1OutputStatus").classList.replace(document.getElementById("io1OutputStatus").classList[1], parsedData.ioOutputStatus.io1) ;
		document.getElementById("io2OutputStatus").classList.replace(document.getElementById("io2OutputStatus").classList[1], parsedData.ioOutputStatus.io2) ;


		document.getElementById("combOutIcon").classList.replace(document.getElementById("combOutIcon").classList[1], parsedData.ioOutputStatus.comb) ;

	}

	if ("ioThresholdIo1" in parsedData) {
		if (document.getElementById("IO1Threshold") != document.activeElement)
			document.getElementById("IO1Threshold").value = parsedData.ioThresholdIo1.toFixed(1) ;
//		document.getElementById("").value = parsedData.ioThresholdIo1 ;
	}
	if ("ioThresholdIo2" in parsedData) {
		if (document.getElementById("IO2Threshold") != document.activeElement)
			document.getElementById("IO2Threshold").value = parsedData.ioThresholdIo2.toFixed(1) ;
//		document.getElementById("").value = parsedData.ioThresholdIo2 ;
	}

	if ("ioDelayTime" in parsedData) {
		if (document.getElementById("ioMappingDelayTime") != document.activeElement)
			document.getElementById("ioMappingDelayTime").value = parsedData.ioDelayTime.toFixed(3) ;
	}

	if ("ioMappingIo1" in parsedData) {
		if (parsedData.ioMappingIo1.source == "timingIo") { // using timing IO (frame sync output)
			document.getElementById("IO1Action").firstChild.textContent = "Frame Sync. Output" ;
			document.getElementById("IO1Debounce").innerHTML = ((parsedData.ioMappingIo1.debounce) ? "True" : "False") ;
			document.getElementById("IO1Invert").innerHTML = ((parsedData.ioMappingIo1.invert) ? "True" : "False") ;
			document.getElementById("IO1Drive").classList.add("disabled") ;
		}
		else
			document.getElementById("IO1Action").firstChild.textContent = "None (Do Nothing)" ;

		document.getElementById("IO1Drive").firstChild.textContent = ((parsedData.ioMappingIo1.drive == 0) ? "None (off)" : (parsedData.ioMappingIo1.drive == 1) ? "1mA" : "20mA") ;

		document.getElementById("ioMappingIo1Source").firstChild.textContent = sourceName(parsedData.ioMappingIo1.source) ;
		stateSelecter(document.getElementById("ioMappingIo1Debounce"), parsedData.ioMappingIo1.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingIo1Invert"), parsedData.ioMappingIo1.invert) ;
		document.getElementById("ioMappingIo1Drive").firstChild.textContent = driveName(parsedData.ioMappingIo1.drive) ;
	}

	if ("ioMappingIo2" in parsedData) {
		if (parsedData.ioMappingIo2.source == "timingIo") { // using timing IO (frame sync output)
			document.getElementById("IO2Action").firstChild.textContent = "Frame Sync. Output" ;
			document.getElementById("IO2Debounce").innerHTML = ((parsedData.ioMappingIo2.debounce) ? "True" : "False") ;
			document.getElementById("IO2Invert").innerHTML = ((parsedData.ioMappingIo2.invert) ? "True" : "False") ;
			document.getElementById("IO2Drive").classList.add("disabled") ;
		}
		else
			document.getElementById("IO2Action").firstChild.textContent = "None (Do Nothing)" ;

		document.getElementById("IO2Drive").firstChild.textContent = ((parsedData.ioMappingIo2.drive == 0) ? "None (off)" : "20mA") ;

		document.getElementById("ioMappingIo2Source").firstChild.textContent = sourceName(parsedData.ioMappingIo2.source) ;
		stateSelecter(document.getElementById("ioMappingIo2Debounce"), parsedData.ioMappingIo2.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingIo2Invert"), parsedData.ioMappingIo2.invert) ;
		document.getElementById("ioMappingIo2Drive").firstChild.textContent = driveName(parsedData.ioMappingIo2.drive) ;
	}


	if ("ioMappingStopRec" in parsedData) {
		document.getElementById("ioMappingStopRecSource").firstChild.textContent = sourceName(parsedData.ioMappingStopRec.source) ;
		stateSelecter(document.getElementById("ioMappingStopRecDebounce"), parsedData.ioMappingStopRec.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingStopRecInvert"), parsedData.ioMappingStopRec.invert) ;
	}
	if ("ioMappingCombOr1" in parsedData) {
		if (parsedData.ioMappingCombOr1.source == "io1") { // if using simple configuration, this should work
			document.getElementById("IO1Debounce").innerHTML = ((parsedData.ioMappingCombOr1.debounce) ? "True" : "False") ;
			document.getElementById("IO1Invert").innerHTML = ((parsedData.ioMappingCombOr1.invert) ? "True" : "False") ;
		}
		document.getElementById("ioMappingCombOr1Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr1.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr1Debounce"), parsedData.ioMappingCombOr1.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr1Invert"), parsedData.ioMappingCombOr1.invert) ;
	}
	if ("ioMappingCombOr2" in parsedData) {
		if (parsedData.ioMappingCombOr2.source == "io2") { // if using simple configuration, this should work
			document.getElementById("IO2Debounce").innerHTML = ((parsedData.ioMappingCombOr2.debounce) ? "True" : "False") ;
			document.getElementById("IO2Invert").innerHTML = ((parsedData.ioMappingCombOr2.invert) ? "True" : "False") ;
		}
		document.getElementById("ioMappingCombOr2Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr2.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr2Debounce"), parsedData.ioMappingCombOr2.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr2Invert"), parsedData.ioMappingCombOr2.invert) ;
	}
	if ("ioMappingCombOr3" in parsedData) { // if using simple configuration, this should work
		if (parsedData.ioMappingCombOr3.source == "io3") {
			document.getElementById("IO3Debounce").innerHTML = ((parsedData.ioMappingCombOr3.debounce) ? "True" : "False") ;
			document.getElementById("IO3Invert").innerHTML = ((parsedData.ioMappingCombOr3.invert) ? "True" : "False") ;
		}

		document.getElementById("ioMappingCombOr3Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr3.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr3Debounce"), parsedData.ioMappingCombOr3.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr3Invert"), parsedData.ioMappingCombOr3.invert) ;
	}

	if ("ioMappingCombXor" in parsedData) {
		document.getElementById("ioMappingCombXorSource").firstChild.textContent = sourceName(parsedData.ioMappingCombXor.source) ;
		stateSelecter(document.getElementById("ioMappingCombXorDebounce"), parsedData.ioMappingCombXor.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombXorInvert"), parsedData.ioMappingCombXor.invert) ;
	}
	if ("ioMappingCombAnd" in parsedData) {
		document.getElementById("ioMappingCombAndSource").firstChild.textContent = sourceName(parsedData.ioMappingCombAnd.source) ;
		stateSelecter(document.getElementById("ioMappingCombAndDebounce"), parsedData.ioMappingCombAnd.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombAndInvert"), parsedData.ioMappingCombAnd.invert) ;
	}


	if ("ioMappingToggleSet" in parsedData) {
		document.getElementById("ioMappingToggleSetSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleSet.source) ;
		stateSelecter(document.getElementById("ioMappingToggleSetDebounce"), parsedData.ioMappingToggleSet.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleSetInvert"), parsedData.ioMappingToggleSet.invert) ;
	}
	if ("ioMappingToggleFlip" in parsedData) {
		document.getElementById("ioMappingToggleFlipSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleFlip.source) ;
		stateSelecter(document.getElementById("ioMappingToggleFlipDebounce"), parsedData.ioMappingToggleFlip.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleFlipInvert"), parsedData.ioMappingToggleFlip.invert) ;
	}
	if ("ioMappingToggleClear" in parsedData) {
		document.getElementById("ioMappingToggleClearSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleClear.source) ;
		stateSelecter(document.getElementById("ioMappingToggleClearDebounce"), parsedData.ioMappingToggleClear.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleClearInvert"), parsedData.ioMappingToggleClear.invert) ;
	}

	if ("ioMappingDelay" in parsedData) {
		document.getElementById("ioMappingDelaySource").firstChild.textContent = sourceName(parsedData.ioMappingDelay.source) ;
		stateSelecter(document.getElementById("ioMappingDelayDebounce"), parsedData.ioMappingDelay.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingDelayInvert"), parsedData.ioMappingDelay.invert) ;
	}

	if ("ioMappingStartRec" in parsedData) {
		document.getElementById("ioMappingStartRecSource").firstChild.textContent = sourceName(parsedData.ioMappingStartRec.source) ;
		stateSelecter(document.getElementById("ioMappingStartRecDebounce"), parsedData.ioMappingStartRec.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingStartRecInvert"), parsedData.ioMappingStartRec.invert) ;
	}

	if ("ioMappingGate" in parsedData) {
		document.getElementById("ioMappingGateSource").firstChild.textContent = sourceName(parsedData.ioMappingGate.source) ;
		stateSelecter(document.getElementById("ioMappingGateDebounce"), parsedData.ioMappingGate.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingGateInvert"), parsedData.ioMappingGate.invert) ;
	}


	if ("ioMappingTrigger" in parsedData) {
		switch(parsedData.ioMappingTrigger.source) {
			case "io1": // 'end trigger' is triggered by IO1
				document.getElementById("IO1Action").firstChild.textContent = "Record End Trigger" ;
				break ;
			case "io2": // 'end trigger' is triggered by IO2
				document.getElementById("IO2Action").firstChild.textContent = "Record End Trigger" ;
				break ;
			case "io3": // 'end trigger' is triggered by IO3
				document.getElementById("IO3Action").firstChild.textContent = "Record End Trigger" ;
				break ;

			case "comb": // 'end trigger' may be triggered by multiple IOs
				if (document.getElementById("ioMappingCombOr1Source").firstChild.textContent == "Input 1 (IO1 in)") // using input 1
					document.getElementById("IO1Action").firstChild.textContent = "Record End Trigger" ;
				if (document.getElementById("ioMappingCombOr2Source").firstChild.textContent == "Input 2 (IO2 in)") // using input 2
					document.getElementById("IO2Action").firstChild.textContent = "Record End Trigger" ;
				if (document.getElementById("ioMappingCombOr3Source").firstChild.textContent == "Input 3 (IO3 in)") // using input 3
					document.getElementById("IO3Action").firstChild.textContent = "Record End Trigger" ;
				break ;
		}
		document.getElementById("ioMappingTriggerSource").firstChild.textContent = sourceName(parsedData.ioMappingTrigger.source) ;
		stateSelecter(document.getElementById("ioMappingTriggerDebounce"), parsedData.ioMappingTrigger.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingTriggerInvert"), parsedData.ioMappingTrigger.invert) ;
	}


	if ("ioMappingShutter" in parsedData) {
		var modeName = ((lastKnownExposureMode == "shutterGating") ? "Shutter Gating" : "Exposure Trigger") ;
		switch(parsedData.ioMappingShutter.source) {
			case "io1": // 'exposure trigger' is triggered by IO1
				document.getElementById("IO1Action").firstChild.textContent = modeName ;
				break ;
			case "io2": // 'exposure trigger' is triggered by IO2
				document.getElementById("IO2Action").firstChild.textContent = modeName ;
				break ;
			case "io3": // 'exposure trigger' is triggered by IO3
				document.getElementById("IO3Action").firstChild.textContent = modeName ;
				break ;

			case "comb": // 'exposure trigger' may be triggered by multiple IOs
				if (document.getElementById("ioMappingCombOr1Source").firstChild.textContent == "Input 1 (IO1 in)") // using input 1
					document.getElementById("IO1Action").firstChild.textContent = modeName ;
				if (document.getElementById("ioMappingCombOr2Source").firstChild.textContent == "Input 2 (IO2 in)") // using input 2
					document.getElementById("IO2Action").firstChild.textContent = modeName ;
				if (document.getElementById("ioMappingCombOr3Source").firstChild.textContent == "Input 3 (IO3 in)") // using input 3
					document.getElementById("IO3Action").firstChild.textContent = modeName ;
				break ;
		}
		document.getElementById("ioMappingShutterSource").firstChild.textContent = sourceName(parsedData.ioMappingShutter.source) ;
		stateSelecter(document.getElementById("ioMappingShutterDebounce"), parsedData.ioMappingShutter.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingShutterInvert"), parsedData.ioMappingShutter.invert) ;
	}

	if ("ioDetailedStatus" in parsedData) {
		if ("detailedComb" in parsedData.ioDetailedStatus) {
		document.getElementById("ioMappingCombOr1Status").classList.replace(document.getElementById("ioMappingCombOr1Status").classList[1], parsedData.ioDetailedStatus.detailedComb.or1) ;
		document.getElementById("ioMappingCombOr2Status").classList.replace(document.getElementById("ioMappingCombOr2Status").classList[1], parsedData.ioDetailedStatus.detailedComb.or2) ;
		document.getElementById("ioMappingCombOr3Status").classList.replace(document.getElementById("ioMappingCombOr3Status").classList[1], parsedData.ioDetailedStatus.detailedComb.or3) ;
		document.getElementById("ioMappingCombXorStatus").classList.replace(document.getElementById("ioMappingCombXorStatus").classList[1], parsedData.ioDetailedStatus.detailedComb.xor) ;
		document.getElementById("ioMappingCombAndStatus").classList.replace(document.getElementById("ioMappingCombAndStatus").classList[1], parsedData.ioDetailedStatus.detailedComb.and) ;

		document.getElementById("combOr1Icon").classList.replace(document.getElementById("combOr1Icon").classList[1], parsedData.ioDetailedStatus.detailedComb.or1) ;
		document.getElementById("combOr2Icon").classList.replace(document.getElementById("combOr2Icon").classList[1], parsedData.ioDetailedStatus.detailedComb.or2) ;
		document.getElementById("combOr3Icon").classList.replace(document.getElementById("combOr3Icon").classList[1], parsedData.ioDetailedStatus.detailedComb.or3) ;
		document.getElementById("combXorIcon").classList.replace(document.getElementById("combXorIcon").classList[1], parsedData.ioDetailedStatus.detailedComb.xor) ;
		document.getElementById("combAndIcon").classList.replace(document.getElementById("combAndIcon").classList[1], parsedData.ioDetailedStatus.detailedComb.and) ;

		}
	}
/*
      "ioMappingCombOr3": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingStopRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingGate": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr1": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombXor": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleSet": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleFlip": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },


      "ioMappingStartRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingIo2": { --
         "source": "alwaysHigh",
         "drive": 0,
         "debounce": false,
         "invert": false
      },

      "ioMappingIo1": { --
         "source": "alwaysHigh",
         "drive": 1,
         "debounce": false,
         "invert": false
      },

      "ioMappingTrigger": { --
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "ioMappingDelay": { --
         "source": "comb",
         "debounce": false,
         "invert": false
      },


      "ioMappingToggleClear": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombAnd": { --
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "ioMappingShutter": {
         "source": "none",
         "debounce": false,
         "invert": false
      }

   },
*/

}



function dataRequester(method, parameter, callMeMaybe) {
	var requestSender = new XMLHttpRequest() ; // set up a new request
	requestSender.open("POST", "/control/" + method, true) ; // use "post", and use the /control/ method
	requestSender.setRequestHeader("Content-Type", "application/json") ; // use json format
	requestSender.withCredentials = true ;

	requestSender.onreadystatechange = function(){ // do something with the response
		if (this.readyState == 4 && this.status == 200){ // wait for successful response
			callMeMaybe(requestSender.responseText) ; // call the callback function with the response text
		}
	}

	requestSender.send(parameter) ;
}


function dataSender(method, parameter){
	var requestSender = new XMLHttpRequest() ;
	requestSender.open("POST", "/control/" + method, true) ;
	requestSender.setRequestHeader("Content-Type", "application/json") ;
	requestSender.withCredentials = true ;
	
	requestSender.send(parameter) ;
}

function dataGetter(method, parameter, callMeMaybe){
	var requestSender = new XMLHttpRequest() ;
	requestSender.open("GET", "/control/" + method + ( (parameter !== "") ? "?" + parameter : "")) ;
	requestSender.setRequestHeader("Content-Type", "application/json") ;

	requestSender.onreadystatechange = function(){ // do something with the response
		if (this.readyState == 4 && this.status == 200){
			callMeMaybe(requestSender.responseText) ; // call this function to deal with the input and update the page
			 // callback function, passing in the string we got back
		}
	}

	requestSender.send(parameter) ;
}



var useServerSentEvents = true;

if (typeof(EventSource) != "undefined") {
	const evtSource = new EventSource("/control/subscribe");

	evtSource.onmessage = function(event) {
		if (DebugOnOff)
			document.getElementById("debugger").innerHTML = "onmessage:" + event.data;
	}
	evtSource.addEventListener("notify", function(event) {pageUpdate(event.data);}, false);
	evtSource.addEventListener("complete", function(event) { pageUpdate(event.data) ; if (DebugOnOff) document.getElementById("debugger").innerHTML = "got complete:" + event.data; }, false);
}
else {
	useServerSentEvents = false;
document.getElementById("refreshAllBox").classList.remove("hidden") ;
}

dataGetter("p", "", pageUpdate) ; // get all the data on startup



var PollCounter = 1 ;
function pollOnlyUpdates() { // some information I can only get if I ask for it, so that's what I do here

	dataGetter('get', 'ioSourceStatus', pageUpdate) ;
	dataGetter('get', 'ioOutputStatus', pageUpdate) ;

	if (PollCounter % 2 == 0) { // every 1 second
		dataGetter('get', 'ioDetailedStatus', pageUpdate) ;
	}

	if (PollCounter % 30 == 0) { // every 15-ish seconds
		dataGetter('get', 'batteryChargePercent', pageUpdate) ; // ask for the battery charge level
	}


	if (!useServerSentEvents) { // no server-sent events; ask for updates
		if (PollCounter % 31 == 0)
			dataGetter('get', 'externalPower', pageUpdate) ; // check for external power connection

	}

	PollCounter++ ;
}



/* check cookies */

switch (getCookie("thm")) {
	case "":
		setCookie("thm", "dt") ;
	case "dt":
		theme("default") ;
		break ;

	case "mo":
		theme("monochrome") ;
		break ;

	case "dk":
		theme("darker") ;
		break ;

	case "lt":
		theme("lighter") ;
		break ;

	case "md":
		theme("monoDark") ;
		break ;

	case "l2":
		theme("newDefault") ;
		break ;
}




/*
	Cookie Descriptions:

	id	name / description
	---|-----------------------|
	fpl	"focus peaking level"	number from 0 to 1
	mc	"mode change"			"n" to change mode on navigation, "m" to change mode manually
	sr	"save recording"		0 when recording was saved, 1 when not saved
	thm	"theme"					2-letter code to indicate each theme
	wo	"warn overwrite"		"a" always warn, "n" never warn, "u" warn on unsaved recordings
	as	"auto save"				<= 0 to not auto save, > 0 to select device to save on
	ff	"file format"			0: H264, 1: DNG, 2: Tiff12, 3: Tiff16(Raw)

*/


var intervalID = setInterval(pollOnlyUpdates, 500) ; // poll the camera for things that are not reported





</script>
</html>



