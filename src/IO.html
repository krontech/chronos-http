<!DOCTYPE html>
<html><head>
<meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8"/>
<title>Chronos</title>


<link rel="stylesheet" href="css/fontFile.css"> 

<link rel="styleSheet" href="css/sizeAndSpacing.css">
<link id="themeSelection" rel="styleSheet" href="css/defaultTheme.css">
<link id="windozeFixer" rel="styleSheet" href="">

<style>


.infoText {
	display: inline-block;
	margin-right: 100px;
}

/******** Specific to this page ********/


/*@media screen and (max-width: 3000px) {
	.leftContainer, .rightContainer { box-shadow: 0 0 3px 3px inset white; }
} */

@media screen and (min-width: 1600px) {
	.leftContainer, .rightContainer { max-width: 1000px; }
	#container1 { margin-bottom: 6px; }
}

.ioStatus.true {
	display: inline-block;
	height: 0;
	width: 0;
	border-left: 10px solid transparent;
	border-right: 10px solid transparent;
	border-bottom: 16px solid green;
}

.ioStatus.false {
	display: inline-block;
	height: 0;
	width: 0;
	border-left: 10px solid transparent;
	border-right: 10px solid transparent;
	border-top: 16px solid #A00;
}


</style>
</head>


<body onclick="">

	<div class="header">
		<div class="titleImage">
			<img id="logoImage" src="Chronos High Speed logo.png">
		</div>

		<!-- <b class="title">&nbsp;CHRONOS</b> -->
		<div class="subTitle">by <a href="https://www.krontech.ca" target="_blank">Kron Technologies</a></div>
	</div>

 <div class="mainContainer"> 

	
	<div class="heading-bar">
		<a id="main" href="./"> <div class="homeIcon"></div> Main </a>
		<a id="playSave" href="PlaySave.html"> <div class="playIcon"></div> Play & Save </a>
		<a id="settings" href="settings.html"> <div class="settingsIcon"></div> Settings </a>
		<a id="ioNav" class="active"> <div class="saveIcon"></div> I/O Config </a>
		<a id="help" href="/apidoc/"> <div class="helpIcon">?</div> Documentation </a>

		<a id="menu" onclick="toggler(this)" class="menuClickOk"> <div class="menuIcon"></div> Menu </a>
		<div id="menuList" onmouseover="menuKeeper()" class="menuContainer menuClickOk">
			<a href="/"> Record (Main) </a>
			<a href="PlaySave.html"> Play & Save </a>
			<a href="/settings.html"> Camera Settings </a>
			<a href="IO.html"> I/O Configuration </a>
			<a href="/apidoc/"> Documentation </a>
			<a onclick="dropDownSelect(this)">Play Mode</a>
			<a onclick="dropDownSelect(this)">Record Mode</a>

			<a onclick="dropDownSelect(this)">Debug Tools</a>

		</div>

	</div>


<!--	<div class="leftContainer">
-->

	<div class="rightContainer">
		<div id="inputList" class="Text-bar">
			<div class="no-click">
				<span>Simple Configuration</span>
			</div>
		</div>

		<div class="horizLayout">
			<b> Input Status </b>
			<br>
			Always High (True): <div id="alwaysHighSourceStatus" class="ioStatus none"></div>
			<br>
			None (False): <div id="noneSourceStatus" class="ioStatus none"></div>
			<br>
			Input 1 (IO1): <div id="io1SourceStatus" class="ioStatus none"></div>
			<br>
			Input 2 (IO2): <div id="io2SourceStatus" class="ioStatus none"></div>
			<br>
			Input 3 (IO3): <div id="io3SourceStatus" class="ioStatus none"></div>
			<br>
			Delay Block: <div id="delaySourceStatus" class="ioStatus none"></div>
			<br>
			Next Segment: <div id="nextSegSourceStatus" class="ioStatus none"></div>
			<br>
			Timing IO: <div id="timingIoSourceStatus" class="ioStatus none"></div>
			<br>
			Display Frame: <div id="dispFrameSourceStatus" class="ioStatus none"></div>
			<br>
			Combinatorial Block: <div id="combSourceStatus" class="ioStatus none"></div>
			<br>
			Shutter: <div id="shutterSourceStatus" class="ioStatus none"></div>
			<br>
			Toggle Block: <div id="toggleSourceStatus" class="ioStatus none"></div>
			<br>
			End Recording: <div id="endRecSourceStatus" class="ioStatus none"></div>
			<br>
			Recording: <div id="recordingSourceStatus" class="ioStatus none"></div>
			<br>
			Start Recording: <div id="startRecSourceStatus" class="ioStatus none"></div>
			<br>
			Software Trigger: <div id="softwareSourceStatus" class="ioStatus none"></div>
		</div>
<!--
//      "alwaysHigh": true,
//      "none": false,
//      "io1": true,
//      "io2": false
//      "io3": false,

//      "delay": false,
//      "nextSeg": false,
//      "timingIo": true,
//      "dispFrame": false,

//      "comb": false,
//      "shutter": true,
//      "toggle": true,

//      "endRec": false,
//      "recording": false,
//      "software": false,
//      "startRec": false,
-->

<!--
   "ioSourceStatus": {
      "io3": false,
      "delay": false,
      "nextSeg": false,
      "timingIo": true,
      "dispFrame": false,
      "alwaysHigh": true,
      "comb": false,
      "none": false,
      "io1": true,
      "shutter": true,
      "toggle": true,
      "endRec": false,
      "recording": false,
      "software": false,
      "startRec": false,
      "io2": false
   },

   "ioOutputStatus": {
      "gate": false,
      "delay": false,
      "start": false,
      "comb": false,
      "shutter": false,
      "toggle": true,
      "stop": false,
      "io1": true,
      "io2": true

   },
-->

		<div class="horizLayout">
			<b> Output Status </b>
			<br>
			Gate: <div id="gateOutputStatus" class="ioStatus none"></div>
			<br>
			Delay: <div id="delayOutputStatus" class="ioStatus none"></div>
			<br>
			Start Recording: <div id="startOutputStatus" class="ioStatus none"></div>
			<br>
			Combinatorial Block: <div id="combOutputStatus" class="ioStatus none"></div>
			<br>
			Shutter: <div id="shutterOutputStatus" class="ioStatus none"></div>
			<br>
			Toggle Block: <div id="toggleOutputStatus" class="ioStatus none"></div>
			<br>
			Stop Recording: <div id="stopOutputStatus" class="ioStatus none"></div>
			<br>
			Output 1 (IO1): <div id="io1OutputStatus" class="ioStatus none"></div>
			<br>
			Output 2 (IO2): <div id="io2OutputStatus" class="ioStatus none"></div>
		</div>


	</div>

	<div id="container1" class="rightContainer">

		<div class="Text-bar">
			<div class="no-click">
				<span>Advanced Configuration</span>
			</div>
		</div>


		<div id="ioMappingStopRecBox" class="horizLayout">
			<b> Stop Recording </b>
<!--			<div id="ioMappingStopRecOutput" class="ioStatus none"></div> -->
			<br>
			<span class="instruction"> Cause the recording to stop </span>
			<br>
			Source:
			<div id="ioMappingStopRecSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingStopRecSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingStopRecDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingStopRecInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombOr1Box" class="horizLayout">
			<b> Combinatorial OR 1 </b>
			<br>
			<span class="instruction"> Select a connection for the 1st combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr1Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingCombOr1SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingCombOr1Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr1Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombOr2Box" class="horizLayout">
			<b> Combinatorial OR 2 </b>
			<br>
			<span class="instruction"> Select a connection for the 2nd combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr2Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingCombOr2SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingCombOr2Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr2Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombOr3Box" class="horizLayout">
			<b> Combinatorial OR 3 </b>
			<br>
			<span class="instruction"> Select a connection for the 3rd combinatorial OR input </span>
			<br>
			Source:
			<div id="ioMappingCombOr3Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingCombOr3SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingCombOr3Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombOr3Invert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombXorBox" class="horizLayout">
			<b> Combinatorial XOR </b>
			<br>
			<span class="instruction"> Select a connection for the combinatorial XOR input </span>
			<br>
			Source:
			<div id="ioMappingCombXorSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingCombXorSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingCombXorDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombXorInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingCombAndBox" class="horizLayout">
			<b> Cominatorial AND </b>
			<br>
			<span class="instruction"> Choose what triggers the Cominatorial AND input </span>
			<br>
			Source:
			<div id="ioMappingCombAndSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingCombAndSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingCombAndDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingCombAndInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingGateBox" class="horizLayout">
			<b> Gate </b>
			<br>
			<span class="instruction"> Gate </span>
			<br>
			Source:
			<div id="ioMappingGateSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingGateSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingGateDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingGateInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleSetBox" class="horizLayout">
			<b> Toggle Set </b>
			<br>
			<span class="instruction"> Choose what will 'Set' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleSetSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingToggleSetSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingToggleSetDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleSetInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleFlipBox" class="horizLayout">
			<b> Toggle Flip </b>
			<br>
			<span class="instruction"> Choose what will 'Flip' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleFlipSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingToggleFlipSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingToggleFlipDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleFlipInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingToggleClearBox" class="horizLayout">
			<b> Toggle Clear </b>
			<br>
			<span class="instruction"> Choose what will 'Clear' the toggle block </span>
			<br>
			Source:
			<div id="ioMappingToggleClearSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingToggleClearSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingToggleClearDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingToggleClearInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingStartRecBox" class="horizLayout">
			<b> Start Recording </b>
			<br>
			<span class="instruction"> Choose what will start a recording </span>
			<br>
			Source:
			<div id="ioMappingStartRecSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingStartRecSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingStartRecDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingStartRecInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingIo1Box" class="horizLayout">
			<b> Output 1 (IO1 out) </b>
			<br>
			<span class="instruction"> Choose when IO1 out does something </span>
			<br>
			Source:
			<div id="ioMappingIo1Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingIo1SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingIo1Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingIo1Invert" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Drive Strength:
			<div id="ioMappingIo1Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">Off</a>
				<a onclick="dropDownSelect(this)">Low (1mA)</a>
				<a onclick="dropDownSelect(this)">High (20mA)</a>
			</div></div>
		</div>

		<div id="ioMappingIo2Box" class="horizLayout">
			<b> Output 2 (IO2 out) </b>
			<br>
			<span class="instruction"> Choose when IO2 out does something </span>
			<br>
			Source:
			<div id="ioMappingIo2Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingIo2SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingIo2Debounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingIo2Invert" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Drive Strength:
			<div id="ioMappingIo2Drive" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">Off</a>
				<a onclick="dropDownSelect(this)">Low (1mA)</a>
				<a onclick="dropDownSelect(this)">High (20mA)</a>
			</div></div>
		</div>



		<div id="ioMappingTriggerBox" class="horizLayout">
			<b> Trigger </b>
			<br>
			<span class="instruction"> Choose what causes a 'Trigger' event </span>
			<br>
			Source:
			<div id="ioMappingTriggerSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingTriggerSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingTriggerDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingTriggerInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>

		<div id="ioMappingDelayBox" class="horizLayout">
			<b> Delay </b>
			<br>
			<span class="instruction"> Choose what causes the Delay Timer to run </span>
			<br>
			Source:
			<div id="ioMappingDelaySource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingDelaySourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingDelayDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingDelayInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="ioMappingShutterBox" class="horizLayout">
			<b> Shutter </b>
			<br>
			<span class="instruction"> Choose what affects the shutter </span>
			<br>
			Source:
			<div id="ioMappingShutterSource" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="ioMappingShutterSourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="ioMappingShutterDebounce" class="button" onclick="debounceOrInvert(this)">False</a>
			<br>
			Invert:
			<a id="ioMappingShutterInvert" class="button" onclick="debounceOrInvert(this)">False</a>
		</div>


		<div id="Box" class="horizLayout">
			<b> -- </b>
			<br>
			<span class="instruction"> Blank </span>
			<br>
			Source:
			<div id="Source" class="selectContainerHolder" onclick=""> Select <div class="selectContainer">
				<a onclick="dropDownSelect(this)">None (False)</a>
				<a onclick="dropDownSelect(this)">Always High (True)</a>
				<a onclick="dropDownSelect(this)">Input 1 (IO1 in)</a>
				<a onclick="dropDownSelect(this)">Input 2 (IO2 in)</a>
				<a onclick="dropDownSelect(this)">Input 3 (IO3 in)</a>
				<a onclick="dropDownSelect(this)">Start of Recording</a>
				<a onclick="dropDownSelect(this)">End of Recording</a>
				<a onclick="dropDownSelect(this)">While Recording</a>
				<a onclick="dropDownSelect(this)">Timing IO</a>
				<a onclick="dropDownSelect(this)">Delay Block</a>
				<a onclick="dropDownSelect(this)">Software Trigger</a>
				<a onclick="dropDownSelect(this)">Toggle Block</a>
				<a onclick="dropDownSelect(this)">Combinatorial Block</a>
				<a onclick="dropDownSelect(this)">Shutter</a>
				<a onclick="dropDownSelect(this)">Next Segment</a>
				<a onclick="dropDownSelect(this)">Display Frame</a>
			</div></div>
			<span id="SourceStatus" class="ioInputStatus">(True/False)</span>
			<br>
			Debounce:
			<a id="Debounce" class="button" onclick="sendIoRequest(this)">False</a>
			<br>
			Invert:
			<a id="Invert" class="button" onclick="sendIoRequest(this)">False</a>
		</div>




	</div>


<!--
   "config": {

      "ioThresholdIo1": 2.49929,
      "ioThresholdIo2": 2.49929,

      "ioMappingCombOr2": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr3": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingStopRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingGate": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr1": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombXor": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleSet": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleFlip": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },


      "ioMappingStartRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingIo2": { --
         "source": "alwaysHigh",
         "drive": 0,
         "debounce": false,
         "invert": false
      },

      "ioMappingIo1": { --
         "source": "alwaysHigh",
         "drive": 1,
         "debounce": false,
         "invert": false
      },

      "ioMappingTrigger": { --
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "ioMappingDelay": { --
         "source": "comb",
         "debounce": false,
         "invert": false
      },


      "ioMappingToggleClear": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombAnd": { --
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "ioMappingShutter": {
         "source": "none",
         "debounce": false,
         "invert": false
      }

   },


   "ioSourceStatus": {
      "io3": false,
      "delay": false,
      "nextSeg": false,
      "timingIo": true,
      "dispFrame": false,
      "alwaysHigh": true,
      "comb": false,
      "none": false,
      "io1": true,
      "shutter": true,
      "toggle": true,
      "endRec": false,
      "recording": false,
      "software": false,
      "startRec": false,
      "io2": false
   },

   "ioOutputStatus": {
      "gate": false,
      "delay": false,
      "start": false,
      "comb": false,
      "shutter": false,
      "toggle": true,
      "stop": false,
      "io1": true,
      "io2": true

   },


   "ioMapping": {

      "combAnd": {
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "delay": {
         "source": "comb",
         "delayTime": 0,
         "debounce": false,
         "invert": false
      },

      "toggleSet": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "gate": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "toggleFlip": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "start": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "shutter": {
         "shutterTriggersFrame": false,
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr1": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr2": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combOr3": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "combXOr": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "trigger": {
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "stop": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "toggleClear": {
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "io1In": {
         "threshold": 2.49929
      },

      "io2In": {
         "threshold": 2.49929
      },

      "io1": {
         "source": "alwaysHigh",
         "driveStrength": 1,
         "debounce": false,
         "invert": false
      },

      "io2": {
         "source": "alwaysHigh",
         "driveStrength": 0,
         "debounce": false,
         "invert": false
      }

   },


-->





	<div class="Text-bar">
		<div id="battery" class="no-click">
			<div id="batteryContainer" class="battery">
				<div id="battery-level"></div>
			</div>
			<span id="battery%">0%</span>
		</div>
	</div>


	<div id="debugBar" class="Text-bar hidden">
		<a id="tester1" onclick="tester1func()"> tester1 </a>
		<a id="tester2" onclick="tester2func()"> tester2 </a>
		<a id="tester3" onclick="tester3func()"> tester3 </a>
		<a id="debugToggle" onclick="toggler(this)"> Display Messages </a>
		<div class="no-click"></div>
		<a onclick='theme("default")'> Default Theme </a>
		<a onclick='theme("monochrome")'> Mono Theme </a>
		<a onclick='theme("darker")'> Darker Theme </a>
		<a onclick='theme("lighter")'> Lighter Theme </a>
		<a onclick='theme("monoDark")'> Mono Dark </a>
		<a onclick='theme("newDefault")'> Light Theme2 </a>
	</div>
	<br>
	<span id="debugger">  </span>

	<span id="debugger2">  </span>
 </div>

<br>
<div class="matchBackground"> This page was made by Nicholas Faliszewski </div>


<div id="popUpBackground" class="popUpBackground hidden">
	<div id="messageWarn" class="popUpMessage">
		<div id="netShareResultBox" class="horizLayout hidden">
			Status of the network share requests
			<br>
			<a style="float: right;" class="button" onclick="dropDownSelect(this)">Ok</a>
		</div>
		<div id="somethingWeirdBox" class="horizLayout hidden">
			Something weird is happening
		</div>
	</div>
</div>

</body>

<script>

var DebugOnOff = true ;


function tester1func() {
//	dataRequester("set", '{"recPreBurst": ' + document.getElementById("preRecFrameNum").value + '}', pageUpdate) ;

}

function tester2func() {

//	dataGetter("p", "", pageUpdate) ; // get all the data
}


function tester3func() {
	// clear recorded buffer
	dataGetter("flushRecording", '', pageUpdate) ;

}


function getCookie(cname) {
  var name = cname + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}







function setCookie (name, value) {
	var expiryDate = new Date() ;

	expiryDate.setTime(expiryDate.getTime() + 1000*60*60*24*90) ; // add 90 days (time is in ms)
//	expiryDate.setTime(expiryDate.getTime() + 1000*60*20) ; // add 20 minutes (time is in ms)

	document.cookie = name + "=" + value + "; expires=" + expiryDate.toUTCString() + "; path=/" ;
}


if (detectIE()) {
	if (DebugOnOff)
		document.getElementById("debugger2").innerHTML = "MS Browser detected" ;
	
	document.getElementById("windozeFixer").href = "css/windozeFixes.css" ;
	
	if ( (parseInt(detectIE()) <= 16) ) { // detect an older version (especially IE)
		if (DebugOnOff)
			document.getElementById("debugger2").innerHTML += " -- Seems to be Internet Explorer" ;
			
		var inputList = document.getElementsByTagName("input"); // get all 'input' types
		for (var i = 0 ; i < inputList.length ; i++) {
			if ( (inputList[i].type.toLowerCase() == "number") || (inputList[i].type.toLowerCase() == "text") )
				inputList[i].style.paddingBottom = "9px" ; // add some padding to the bottom of number or text inputs
		}
		
		document.getElementById("postTriggerSlider").addEventListener('change', function() { changeNumberOften(document.getElementById("postTriggerSlider")) ; }) ;
	}
}



function detectIE() {
  var ua = window.navigator.userAgent;

  // Test values; Uncomment to check result …

  // IE 10
  // ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)';
  
  // IE 11
  // ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko';
  
  // Edge 12 (Spartan)
  // ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0';
  
  // Edge 13
  // ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586';

  var msie = ua.indexOf('MSIE ');
  if (msie > 0) {
    // IE 10 or older => return version number
    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
  }

  var trident = ua.indexOf('Trident/');
  if (trident > 0) {
    // IE 11 => return version number
    var rv = ua.indexOf('rv:');
    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
  }

  var edge = ua.indexOf('Edge/');
  if (edge > 0) {
    // Edge (IE 12+) => return version number
    return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
  }

  // other browser
  return false;
}



function theme(selection) { // set a new stylesheet to use

	if ( (selection == "default") || (selection == "monochrome") || (selection == "darker") || (selection == "lighter") || (selection == "monoDark") || (selection == "newDefault") ) {
		document.getElementById("themeSelection").href = "/css/" + selection + "Theme.css" ;
	}
}


function sendIoRequest (parent) {
	var sliceAmount = 0 ;
	switch (parent.id.slice(-5)) {
		case "Drive": // Drive
			sliceAmount = -5 ;
			break ;
		case "nvert": // Invert
			sliceAmount = -6 ;
			break ;
		case "ounce": // Debounce
			sliceAmount = -8 ;
			break ;
		case "ource": // Source
		default:
			sliceAmount = -6 ;
			break ;
	}

	var baseName = parent.id.slice(0, sliceAmount) ;

	var debounce = "false" ;
	if (document.getElementById(baseName + "Debounce").classList.contains("active"))
		debounce = "true" ;

	var invert = "false" ;
	if (document.getElementById(baseName + "Invert").classList.contains("active"))
		invert = "true" ;

	var source="" ;
	switch (document.getElementById(baseName + "Source").firstChild.textContent) {
		case "None (False)":
			source = "none" ;
			break ;
		case "Always High (True)":
			source = "alwaysHigh" ;
			break ;
		case "Input 1 (IO1 in)":
			source = "io1" ;
			break ;	
		case "Input 2 (IO2 in)":
			source = "io2" ;
			break ;
		case "Input 3 (IO3 in)":
			source = "io3" ;
			break ;
		case "Start of Recording":
			source = "startRec" ;
			break ;
		case "End of Recording":
			source = "endRec" ;
			break ;
		case "While Recording":
			source = "recording" ;
			break ;
		case "Timing IO":
			source = "timingIo" ;
			break ;
		case "Delay Block":
			source = "delay" ;
			break ;
		case "Software Trigger":
			source = "software" ;
			break ;
		case "Toggle Block":
			source = "toggle" ;
			break ;
		case "Combinatorial Block":
			source = "comb" ;
			break ;
		case "Shutter":
			source = "shutter" ;
			break ;
		case "Next Segment":
			source = "nextSeg" ;
			break ;
		case "Display Frame":
			source = "dispFrame" ;
			break ;
	}

	var request = '{"' + baseName + '": {"source": "' + source + '", "debounce": ' + debounce + ', "invert": ' + invert ;

	if ( (baseName == "ioMappingIo1") || (baseName == "ioMappingIo2") ) {
		request += ', "drive": ' ;
		switch (document.getElementById(baseName + "Drive").firstChild.textContent) {
			case "Low (1mA)":
				request += "1" ;
				break ;
			case "High (20mA)":
				request += "2" ;
				break ;
			default:
				request += "0" ;
		}
	}

	request += '}}' ;

	dataRequester("set", request, pageUpdate) ; // send the request
}

function debounceOrInvert(element) { // similar to toggle function, but specific to ioMapping* objects
	var leftRight = 0 ;

	if (element.classList.contains("active")) { // changing to 'inactive' or no state set previously
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
		element.innerHTML = "False" ;
	}
	else if (element.classList.contains("disabled")) { // button disabled
		return ; // don't do anything
	}
	else {
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
		element.innerHTML = "True" ;
	}

	sendIoRequest(element) ; // make and send a request for an IO change
}


var dropDownFunctions = { 
				"None (False)":			function(parent) { parent.firstChild.textContent = "None (False)" ; sendIoRequest(parent) ; },
				"Always High (True)":	function(parent) { parent.firstChild.textContent = "Always High (True)" ; sendIoRequest(parent) ; },
				"Input 1 (IO1 in)":		function(parent) { parent.firstChild.textContent = "Input 1 (IO1 in)" ; sendIoRequest(parent) ; },
				"Input 2 (IO2 in)":		function(parent) { parent.firstChild.textContent = "Input 2 (IO2 in)" ; sendIoRequest(parent) ; },
				"Input 3 (IO3 in)":		function(parent) { parent.firstChild.textContent = "Input 3 (IO3 in)" ; sendIoRequest(parent) ; },
				"Start of Recording":	function(parent) { parent.firstChild.textContent = "Start of Recording" ; sendIoRequest(parent) ; },
				"End of Recording":		function(parent) { parent.firstChild.textContent = "End of Recording" ; sendIoRequest(parent) ; },
				"While Recording":		function(parent) { parent.firstChild.textContent = "While Recording" ; sendIoRequest(parent) ; },
				"Timing IO":			function(parent) { parent.firstChild.textContent = "Timing IO" ; sendIoRequest(parent) ; },
				"Delay Block":			function(parent) { parent.firstChild.textContent = "Delay Block" ; sendIoRequest(parent) ; },
				"Software Trigger":		function(parent) { parent.firstChild.textContent = "Software Trigger" ; sendIoRequest(parent) ; },
				"Toggle Block":			function(parent) { parent.firstChild.textContent = "Togle Block" ; sendIoRequest(parent) ; },
				"Combinatorial Block":	function(parent) { parent.firstChild.textContent = "Combinatorial Block" ; sendIoRequest(parent) ; },
				"Shutter":				function(parent) { parent.firstChild.textContent = "Shutter" ; sendIoRequest(parent) ; },
				"Next Segment":			function(parent) { parent.firstChild.textContent = "Next Segment" ; sendIoRequest(parent) ; },
				"Display Frame":		function(parent) { parent.firstChild.textContent = "Display Frame" ; sendIoRequest(parent) ; },

				"Off":					function(parent) { parent.firstChild.textContent = "Off" ; sendIoRequest(parent) ; },
				"Low (1mA)":			function(parent) { parent.firstChild.textContent = "Low (1mA)" ; sendIoRequest(parent) ; },
				"High (20mA)":			function(parent) { parent.firstChild.textContent = "High (20mA)" ; sendIoRequest(parent) ; },

				"Ok":					function() { document.getElementById("popUpBackground").classList.add("hidden") ; document.getElementById("netShareResultBox").classList.add("hidden") ;  dataGetter('get', 'externalStorage', pageUpdate) ; },

						}


function dropDownSelect (element) {
	if (element.innerText in dropDownFunctions) // if the key-value exists
		dropDownFunctions[element.innerText](element.parentElement.parentElement) ; // run the function
}



var inputFunctions = { "segmentNum":			function(value) { dataRequester("set", '{"recSegments": ' + value + '}', pageUpdate) ; },

						"colourDefaultBtn":		function() { detourRequester("set", '{"colorMatrix": [1.91455, -0.57666, -0.234131,  -0.30542, 1.3894, -0.0966797,  0.127197, -0.952881, 1.64917]}', pageUpdate) ; },
						"colourIdentityBtn":	function() { detourRequester("set", '{"colorMatrix": [1.0, 0.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0, 1.0]}', pageUpdate) ; },
						"colourApplyBtn":		function() { detourRequester("set", '{"colorMatrix": [' + document.getElementById("colMatrixa").value + ', ' + document.getElementById("colMatrixb").value + ', ' + document.getElementById("colMatrixc").value + ', ' + document.getElementById("colMatrixd").value + ', ' + document.getElementById("colMatrixe").value + ', ' + document.getElementById("colMatrixf").value + ', ' + document.getElementById("colMatrixg").value + ', ' + document.getElementById("colMatrixh").value + ', ' + document.getElementById("colMatrixi").value + ']}', pageUpdate) ; },
						"colourPreset1Btn":		function() { detourRequester("set", '{"colorMatrix": [1.91455, -0.57666, -0.234131,  -0.30542, 1.3894, -0.0966797,  0.127197, -0.952881, 1.64917]}', pageUpdate) ; },
						"colourPreset2Btn":		function() { detourRequester("set", '{"colorMatrix": [1.23291, 0.646729, -0.776367,  -0.321777, 1.68994, -0.380859,  -0.0612793, -0.640869,1.52563]}', pageUpdate) ; },

						"whiteBalApplyBtn":		function() { detourRequester("set", '{"wbColor": [' + document.getElementById("whiteBalNuma").value + ', ' + document.getElementById("whiteBalNumb").value + ', ' + document.getElementById("whiteBalNumc").value + ']}', pageUpdate) ; },
					 }


function justRunSomething(element) {
	if (element.id in inputFunctions) // if the key-value exists
		inputFunctions[element.id](element.value) ; // run the function (with the value given)
}



document.getElementById("menu").onmouseenter = function(){ document.getElementById("menuList").style.display = "block" ; }
document.getElementById("menu").onmouseleave = function() {
	var otherMenu = document.getElementById("menuList") ;
	setTimeout( function() {
		if (!document.getElementById("menu").classList.contains("active"))
			document.getElementById("menuList").style.display = "" ;
	}, 50) ;
}


window.onclick = function(event) { // check where a click was: if it was outside a menu, close that menu
	if ( !event.target.matches(".menuClickOk") && (event.target.parent == undefined || !event.target.parent.matches(".menuClickOk"))
	&& (document.getElementById("menu").matches(".active")) ) {
		toggler(document.getElementById("menu")) ; // toggle off the button (and close the menu)
	}
}



var nameChange = {
					"ioMappingStopRecDebounce":		[ "False", "True"],
					"ioMappingStopRecInvert":		[ "False", "True"],
					"ioMappingCombOr1Debounce":		[ "False", "True"],
					"ioMappingCombOr1Invert":		[ "False", "True"],
					"ioMappingCombOr2Debounce":		[ "False", "True"],
					"ioMappingCombOr2Invert":		[ "False", "True"],
					"ioMappingCombOr3Debounce":		[ "False", "True"],
					"ioMappingCombOr3Invert":		[ "False", "True"],
					"ioMappingCombXorDebounce":		[ "False", "True"],
					"ioMappingCombXorInvert":		[ "False", "True"],
					"ioMappingCombAndDebounce":		[ "False", "True"],
					"ioMappingCombAndInvert":		[ "False", "True"],
					"ioMappingGateDebounce":		[ "False", "True"],
					"ioMappingGateInvert":			[ "False", "True"],
					"ioMappingToggleSetDebounce":	[ "False", "True"],
					"ioMappingToggleSetInvert":		[ "False", "True"],
					"ioMappingToggleFlipDebounce":	[ "False", "True"],
					"ioMappingToggleFlipInvert":	[ "False", "True"],
					"ioMappingToggleClearDebounce":	[ "False", "True"],
					"ioMappingToggleClearInvert":	[ "False", "True"],
					"ioMappingStartRecDebounce":	[ "False", "True"],
					"ioMappingStartRecInvert":		[ "False", "True"],
					"ioMappingIo1Debounce":			[ "False", "True"],
					"ioMappingIo1Invert":			[ "False", "True"],
					"ioMappingIo2Debounce":			[ "False", "True"],
					"ioMappingIo2Invert":			[ "False", "True"],
					"ioMappingTriggerDebounce":		[ "False", "True"],
					"ioMappingTriggerInvert":		[ "False", "True"],
					"ioMappingDelayDebounce":		[ "False", "True"],
					"ioMappingDelayInvert":			[ "False", "True"],
					"ioMappingShutterDebounce":		[ "False", "True"],
					"ioMappingShutterInvert":		[ "False", "True"],
				}

var buttonFunctions = {	"menu":			[ function(){ document.getElementById("menuList").style.display = "" ; }, function(){ menuKeeper() ; document.getElementById("menuList").style.display = "block" ;} ],					

						"debugToggle":			[ function(){ DebugOnOff = false ; document.getElementById("debugger").innerHTML = "" ; document.getElementById("debugger2").innerHTML = "" ; }, function() { DebugOnOff = true ; } ],
						"displayToggleButton":	[ function(){ dataRequester("set", '{"backlightEnabled": false}', pageUpdate) ; }, function(){ dataRequester("set", '{"backlightEnabled": true}', pageUpdate) ; } ],
						"autoSaveButton":		[ function(){ if (getCookie("as") > 0) { setCookie("as", parseInt(getCookie("as") * -1)) ; } else { setCookie("as", 0) ; } }, function() { if (getCookie("as") < 0) { setCookie("as", parseInt(getCookie("as") * -1)) ; } else { setCookie("as", 1) ; } } ],

						"disableRBButton":		[ function(){ dataSender("set", '{"disableRingBuffer": 0}') ; }, function() { dataSender("set", '{"disableRingBuffer": 1}') ; } ],
						"smbPassShowHide":		[ function(){ document.getElementById("smbPass").type="password" ; document.getElementById("smbPass").placeholder="******" ; }, function(){ document.getElementById("smbPass").type="text" ; document.getElementById("smbPass").placeholder="s3cr3t" ; } ],

					  }


function toggler(element) { // toggle the class (active/inactive), change the name, and run a function for a toggle button/switch
	var leftRight = 0 ;

	if (element.classList.contains("active")) { // changing to 'inactive' or no state set previously
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
		leftRight = 0 ; // use the 'left' column for names / functions
	}
	else if (element.classList.contains("disabled")) { // button disabled
		return ; // don't do anything
	}
	else {
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
		leftRight = 1 ; // use the 'right' column for names / functions
	}

	if (element.id in nameChange) // check if key-value exists
		element.innerHTML = nameChange[element.id][leftRight] ; // set name to the left (inactive) or right (active) one

	if (element.id in buttonFunctions) // if the key-value exists
		buttonFunctions[element.id][leftRight](element) ; // run the left (inactive) or right (active) function
}

function stateSelecter(element, state) { // this is like toggler above, but doesn't run the function ; set the class (active/inactive), change the name

	if (state) { // switch to active
		element.classList.remove("inactive") ; // remove the "inactive" styling
		element.classList.add("active") ; // use the "active" styling
	}
	else { // switch to inactive
		element.classList.remove("active") ; // remove the "active" styling
		element.classList.add("inactive") ; // use the "inactive" styling
	}

	state *= 1 ;

	if (element.id in nameChange) // check if key-value exists
		element.innerHTML = nameChange[element.id][state] ; // set name to the left (inactive) or right (active) one
}


function menuKeeper() {
	document.getElementById("menu").classList.remove("inactive");
	document.getElementById("menu").classList.add("active");
}


function batteryPercent(level, charging) { // set the percentage (level) of the battery (and whether it's charging)
	var indicator = document.getElementById("battery-level") ;
	var text = document.getElementById("battery%") ;

	if (level <= 100 && level >= 0) { // not charging (and level is ok)
		text.innerHTML = level.toString() + "%" ;


		if (charging) {
			indicator.style.height = "100%" ; // just make the level full when charging
			indicator.style.backgroundColor = "white" ; // white background while charging
			indicator.innerHTML = '<div id="chargeIcon" class="hidden"></div>' ; // add the charging indicator
		}
		else {
			indicator.style.height = level.toString() + "%" ;
			indicator.innerHTML = '' ; // clear the charging icon

			if (level <= 20)
				indicator.style.backgroundColor = "#a00" ; // red (low)
			else if (level <= 55)
				indicator.style.backgroundColor = "#e7ba00" ; // yellow (less than half)
			else
				indicator.style.backgroundColor = "green" ; // green (fine / more than half)
		}
	}
}


var lastKnownBatteryLevel = 0 ;
var lastKnownExternalPower = false ;

function driveName(value) {
	switch (value) {
		case 1:
			return "Low (1mA)" ;
		case 2:
			return "High (20mA)" ;
		case 0:
			return "Off" ;

		default:
			return "Unkown (" + value + ")" ;
	}
}

function sourceName(source) {
	switch (source) {
		case "none":
			return "None (False)" ;
		case "alwaysHigh":
			return "Always High (True)" ;
		case "io1":
			return "Input 1 (IO1 in)" ;
		case "io2":
			return "Input 2 (IO2 in)" ;
		case "io3":
			return "Input 3 (IO3 in)" ;
		case "startRec":
			return "Start of Recording" ;
		case "endRec":
			return "End of Recording" ;
		case "recording":
			return "While Recording" ;
		case "timingIo":
			return "Timing IO" ;
		case "delay":
			return "Delay Block" ;
		case "software":
			return "Software Trigger" ;
		case "toggle":
			return "Toggle Block" ;
		case "comb":
			return "Combinatorial Block" ;
		case "shutter":
			return "Shutter" ;
		case "nextSeg":
			return "Next Segment" ;
		case "dispFrame":
			return "Display Frame" ;

		default:
			return "Unknown" ;
	}
}


function pageUpdate(rawData){
	var parsedData = JSON.parse(rawData) ;

	if (DebugOnOff)
		document.getElementById("debugger").innerHTML += "<br><br>got info:" + rawData ;

	if ("batteryChargePercent" in parsedData) {
		lastKnownBatteryLevel = Math.round(parsedData.batteryChargePercent) ; // set the last known battery percent value
		batteryPercent(lastKnownBatteryLevel, lastKnownExternalPower) ; // update the battery indicator
	}

	if ("externalPower" in parsedData) {
		lastKnownExternalPower = parsedData.externalPower ; // set the last known power connection
		batteryPercent(lastKnownBatteryLevel, lastKnownExternalPower) ; // update the battery indicator
	}


	if ("ioSourceStatus" in parsedData) {

//		document.getElementById("alwaysHighSourceStatus").classList.add("true") ;
//		document.getElementById("noneSourceStatus").classList.add("false") ;


		document.getElementById("alwaysHighSourceStatus").classList.replace(document.getElementById("alwaysHighSourceStatus").classList[1], parsedData.ioSourceStatus.alwaysHigh) ;
		document.getElementById("noneSourceStatus").classList.replace(document.getElementById("noneSourceStatus").classList[1], parsedData.ioSourceStatus.none) ;
		document.getElementById("io1SourceStatus").classList.replace(document.getElementById("io1SourceStatus").classList[1], parsedData.ioSourceStatus.io1) ;
		document.getElementById("io2SourceStatus").classList.replace(document.getElementById("io2SourceStatus").classList[1], parsedData.ioSourceStatus.io2) ;
		document.getElementById("io3SourceStatus").classList.replace(document.getElementById("io3SourceStatus").classList[1], parsedData.ioSourceStatus.io3) ;

		document.getElementById("delaySourceStatus").classList.replace(document.getElementById("delaySourceStatus").classList[1], parsedData.ioSourceStatus.delay) ;
		document.getElementById("nextSegSourceStatus").classList.replace(document.getElementById("nextSegSourceStatus").classList[1], parsedData.ioSourceStatus.nextSeg) ;
		document.getElementById("timingIoSourceStatus").classList.replace(document.getElementById("timingIoSourceStatus").classList[1], parsedData.ioSourceStatus.timingIo) ;
		document.getElementById("dispFrameSourceStatus").classList.replace(document.getElementById("dispFrameSourceStatus").classList[1], parsedData.ioSourceStatus.dispFrame) ;
		document.getElementById("combSourceStatus").classList.replace(document.getElementById("combSourceStatus").classList[1], parsedData.ioSourceStatus.comb) ;
		document.getElementById("shutterSourceStatus").classList.replace(document.getElementById("shutterSourceStatus").classList[1], parsedData.ioSourceStatus.shutter) ;
		document.getElementById("toggleSourceStatus").classList.replace(document.getElementById("toggleSourceStatus").classList[1], parsedData.ioSourceStatus.toggle) ;

		document.getElementById("endRecSourceStatus").classList.replace(document.getElementById("endRecSourceStatus").classList[1], parsedData.ioSourceStatus.endRec) ;
		document.getElementById("recordingSourceStatus").classList.replace(document.getElementById("recordingSourceStatus").classList[1], parsedData.ioSourceStatus.recording) ;
		document.getElementById("startRecSourceStatus").classList.replace(document.getElementById("startRecSourceStatus").classList[1], parsedData.ioSourceStatus.software) ;
		document.getElementById("softwareSourceStatus").classList.replace(document.getElementById("softwareSourceStatus").classList[1], parsedData.ioSourceStatus.startRec) ;

//      "alwaysHigh": true,
//      "none": false,
//      "io1": true,
//      "io2": false
//      "io3": false,

//      "delay": false,
//      "nextSeg": false,
//      "timingIo": true,
//      "dispFrame": false,

//      "comb": false,
//      "shutter": true,
//      "toggle": true,
//      "endRec": false,
//      "recording": false,
//      "software": false,
//      "startRec": false,

		var allInputs = document.getElementsByClassName("ioInputStatus") ;

		for (var i = 0 ; i < allInputs.length; i++) {
			switch (allInputs[i].previousElementSibling.firstChild.textContent) {
				case "None (False)":
					allInputs[i].textContent = parsedData.ioSourceStatus.none ;
					break ;
				case "Always High (True)":
					allInputs[i].textContent = parsedData.ioSourceStatus.alwaysHigh ;
					break ;
				case "Input 1 (IO1 in)":
					allInputs[i].textContent = parsedData.ioSourceStatus.io1 ;
					break ;	
				case "Input 2 (IO2 in)":
					allInputs[i].textContent = parsedData.ioSourceStatus.io2 ;
					break ;
				case "Input 3 (IO3 in)":
					allInputs[i].textContent = parsedData.ioSourceStatus.io3 ;
					break ;
				case "Start of Recording":
					allInputs[i].textContent = parsedData.ioSourceStatus.startRec ;
					break ;
				case "End of Recording":
					allInputs[i].textContent = parsedData.ioSourceStatus.endRec ;
					break ;
				case "While Recording":
					allInputs[i].textContent = parsedData.ioSourceStatus.recording ;
					break ;
				case "Timing IO":
					allInputs[i].textContent = parsedData.ioSourceStatus.timingIo ;
					break ;
				case "Delay Block":
					allInputs[i].textContent = parsedData.ioSourceStatus.delay ;
					break ;
				case "Software Trigger":
					allInputs[i].textContent = parsedData.ioSourceStatus.software ;
					break ;
				case "Toggle Block":
					allInputs[i].textContent = parsedData.ioSourceStatus.toggle ;
					break ;
				case "Combinatorial Block":
					allInputs[i].textContent = parsedData.ioSourceStatus.comb ;
					break ;
				case "Shutter":
					allInputs[i].textContent = parsedData.ioSourceStatus.shutter ;
					break ;
				case "Next Segment":
					allInputs[i].textContent = parsedData.ioSourceStatus.nextSeg ;
					break ;
				case "Display Frame":
					allInputs[i].textContent = parsedData.ioSourceStatus.dispFrame ;
					break ;
			}
		}

	}

	if ("ioOutputStatus" in parsedData) {
//      "gate": false,
//      "delay": false,
//      "start": false,
//      "comb": false,
//      "shutter": false,
//      "toggle": true,
//      "stop": false,
//      "io1": true,
//      "io2": true

		document.getElementById("gateOutputStatus").classList.add(parsedData.ioOutputStatus.gate) ;
		document.getElementById("delayOutputStatus").classList.add(parsedData.ioOutputStatus.delay) ;
		document.getElementById("startOutputStatus").classList.add(parsedData.ioOutputStatus.start) ;
		document.getElementById("combOutputStatus").classList.add(parsedData.ioOutputStatus.comb) ;
		document.getElementById("shutterOutputStatus").classList.add(parsedData.ioOutputStatus.shutter) ;
		document.getElementById("toggleOutputStatus").classList.add(parsedData.ioOutputStatus.toggle) ;
		document.getElementById("stopOutputStatus").classList.add(parsedData.ioOutputStatus.stop) ;
		document.getElementById("io1OutputStatus").classList.add(parsedData.ioOutputStatus.io1) ;
		document.getElementById("io2OutputStatus").classList.add(parsedData.ioOutputStatus.io2) ;

//		document.getElementById("ioMappingStopRecOutput").classList.replace(document.getElementById("ioMappingStopRecOutput").classList[1], parsedData.ioOutputStatus.stop) ;
	}

	if ("ioThresholdIo1" in parsedData) {
//		document.getElementById("").value = parsedData.ioThresholdIo1 ;
	}
	if ("ioThresholdIo2" in parsedData) {
//		document.getElementById("").value = parsedData.ioThresholdIo2 ;
	}

	if ("ioMappingStopRec" in parsedData) {
		document.getElementById("ioMappingStopRecSource").firstChild.textContent = sourceName(parsedData.ioMappingStopRec.source) ;
		stateSelecter(document.getElementById("ioMappingStopRecDebounce"), parsedData.ioMappingStopRec.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingStopRecInvert"), parsedData.ioMappingStopRec.invert) ;
	}
	if ("ioMappingCombOr1" in parsedData) {
		document.getElementById("ioMappingCombOr1Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr1.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr1Debounce"), parsedData.ioMappingCombOr1.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr1Invert"), parsedData.ioMappingCombOr1.invert) ;
	}
	if ("ioMappingCombOr2" in parsedData) {
		document.getElementById("ioMappingCombOr2Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr2.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr2Debounce"), parsedData.ioMappingCombOr2.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr2Invert"), parsedData.ioMappingCombOr2.invert) ;
	}
	if ("ioMappingCombOr3" in parsedData) {
		document.getElementById("ioMappingCombOr3Source").firstChild.textContent = sourceName(parsedData.ioMappingCombOr3.source) ;
		stateSelecter(document.getElementById("ioMappingCombOr3Debounce"), parsedData.ioMappingCombOr3.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombOr3Invert"), parsedData.ioMappingCombOr3.invert) ;
	}


	if ("ioMappingCombXor" in parsedData) {
		document.getElementById("ioMappingCombXorSource").firstChild.textContent = sourceName(parsedData.ioMappingCombXor.source) ;
		stateSelecter(document.getElementById("ioMappingCombXorDebounce"), parsedData.ioMappingCombXor.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombXorInvert"), parsedData.ioMappingCombXor.invert) ;
	}
	if ("ioMappingCombAnd" in parsedData) {
		document.getElementById("ioMappingCombAndSource").firstChild.textContent = sourceName(parsedData.ioMappingCombAnd.source) ;
		stateSelecter(document.getElementById("ioMappingCombAndDebounce"), parsedData.ioMappingCombAnd.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingCombAndInvert"), parsedData.ioMappingCombAnd.invert) ;
	}
	if ("ioMappingGate" in parsedData) {
		document.getElementById("ioMappingGateSource").firstChild.textContent = sourceName(parsedData.ioMappingGate.source) ;
		stateSelecter(document.getElementById("ioMappingGateDebounce"), parsedData.ioMappingGate.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingGateInvert"), parsedData.ioMappingGate.invert) ;
	}


	if ("ioMappingToggleSet" in parsedData) {
		document.getElementById("ioMappingToggleSetSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleSet.source) ;
		stateSelecter(document.getElementById("ioMappingToggleSetDebounce"), parsedData.ioMappingToggleSet.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleSetInvert"), parsedData.ioMappingToggleSet.invert) ;
	}
	if ("ioMappingToggleFlip" in parsedData) {
		document.getElementById("ioMappingToggleFlipSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleFlip.source) ;
		stateSelecter(document.getElementById("ioMappingToggleFlipDebounce"), parsedData.ioMappingToggleFlip.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleFlipInvert"), parsedData.ioMappingToggleFlip.invert) ;
	}
	if ("ioMappingToggleClear" in parsedData) {
		document.getElementById("ioMappingToggleClearSource").firstChild.textContent = sourceName(parsedData.ioMappingToggleClear.source) ;
		stateSelecter(document.getElementById("ioMappingToggleClearDebounce"), parsedData.ioMappingToggleClear.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingToggleClearInvert"), parsedData.ioMappingToggleClear.invert) ;
	}


	if ("ioMappingStartRec" in parsedData) {
		document.getElementById("ioMappingStartRecSource").firstChild.textContent = sourceName(parsedData.ioMappingStartRec.source) ;
		stateSelecter(document.getElementById("ioMappingStartRecDebounce"), parsedData.ioMappingStartRec.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingStartRecInvert"), parsedData.ioMappingStartRec.invert) ;
	}
	if ("ioMappingIo1" in parsedData) {
		document.getElementById("ioMappingIo1Source").firstChild.textContent = sourceName(parsedData.ioMappingIo1.source) ;
		stateSelecter(document.getElementById("ioMappingIo1Debounce"), parsedData.ioMappingIo1.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingIo1Invert"), parsedData.ioMappingIo1.invert) ;
		document.getElementById("ioMappingIo1Drive").firstChild.textContent = driveName(parsedData.ioMappingIo1.drive) ;
	}
	if ("ioMappingIo2" in parsedData) {
		document.getElementById("ioMappingIo2Source").firstChild.textContent = sourceName(parsedData.ioMappingIo2.source) ;
		stateSelecter(document.getElementById("ioMappingIo2Debounce"), parsedData.ioMappingIo2.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingIo2Invert"), parsedData.ioMappingIo2.invert) ;
		document.getElementById("ioMappingIo2Drive").firstChild.textContent = driveName(parsedData.ioMappingIo2.drive) ;
	}


	if ("ioMappingTrigger" in parsedData) {
		document.getElementById("ioMappingTriggerSource").firstChild.textContent = sourceName(parsedData.ioMappingTrigger.source) ;
		stateSelecter(document.getElementById("ioMappingTriggerDebounce"), parsedData.ioMappingTrigger.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingTriggerInvert"), parsedData.ioMappingTrigger.invert) ;
	}
	if ("ioMappingDelay" in parsedData) {
		document.getElementById("ioMappingDelaySource").firstChild.textContent = sourceName(parsedData.ioMappingDelay.source) ;
		stateSelecter(document.getElementById("ioMappingDelayDebounce"), parsedData.ioMappingDelay.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingDelayInvert"), parsedData.ioMappingDelay.invert) ;
	}
	if ("ioMappingShutter" in parsedData) {
		document.getElementById("ioMappingShutterSource").firstChild.textContent = sourceName(parsedData.ioMappingShutter.source) ;
		stateSelecter(document.getElementById("ioMappingShutterDebounce"), parsedData.ioMappingShutter.debounce) ; // set the debounce state
		stateSelecter(document.getElementById("ioMappingShutterInvert"), parsedData.ioMappingShutter.invert) ;
	}
/*
      "ioMappingCombOr3": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingStopRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingGate": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombOr1": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombXor": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleSet": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingToggleFlip": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },


      "ioMappingStartRec": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingIo2": { --
         "source": "alwaysHigh",
         "drive": 0,
         "debounce": false,
         "invert": false
      },

      "ioMappingIo1": { --
         "source": "alwaysHigh",
         "drive": 1,
         "debounce": false,
         "invert": false
      },

      "ioMappingTrigger": { --
         "source": "io1",
         "debounce": false,
         "invert": true
      },

      "ioMappingDelay": { --
         "source": "comb",
         "debounce": false,
         "invert": false
      },


      "ioMappingToggleClear": { --
         "source": "none",
         "debounce": false,
         "invert": false
      },

      "ioMappingCombAnd": { --
         "source": "alwaysHigh",
         "debounce": false,
         "invert": false
      },

      "ioMappingShutter": {
         "source": "none",
         "debounce": false,
         "invert": false
      }

   },
*/

}



function dataRequester(method, parameter, callMeMaybe) {
	var requestSender = new XMLHttpRequest() ; // set up a new request
	requestSender.open("POST", "/control/" + method, true) ; // use "post", and use the /control/ method
	requestSender.setRequestHeader("Content-Type", "application/json") ; // use json format
	requestSender.withCredentials = true ;

	requestSender.onreadystatechange = function(){ // do something with the response
		if (this.readyState == 4 && this.status == 200){ // wait for successful response
			callMeMaybe(requestSender.responseText) ; // call the callback function with the response text
		}
	}

	requestSender.send(parameter) ;
}


function dataSender(method, parameter){
	var requestSender = new XMLHttpRequest() ;
	requestSender.open("POST", "/control/" + method, true) ;
	requestSender.setRequestHeader("Content-Type", "application/json") ;
	requestSender.withCredentials = true ;
	
	requestSender.send(parameter) ;
}

function dataGetter(method, parameter, callMeMaybe){
	var requestSender = new XMLHttpRequest() ;
	requestSender.open("GET", "/control/" + method + ( (parameter !== "") ? "?" + parameter : "")) ;
	requestSender.setRequestHeader("Content-Type", "application/json") ;

	requestSender.onreadystatechange = function(){ // do something with the response
		if (this.readyState == 4 && this.status == 200){
			callMeMaybe(requestSender.responseText) ; // call this function to deal with the input and update the page
			 // callback function, passing in the string we got back
		}
	}

	requestSender.send(parameter) ;
}



var useServerSentEvents = true;

if (typeof(EventSource) != "undefined") {
	const evtSource = new EventSource("/control/subscribe");

	evtSource.onmessage = function(event) {
		if (DebugOnOff)
			document.getElementById("debugger").innerHTML = "onmessage:" + event.data;
	}
	evtSource.addEventListener("notify", function(event) {pageUpdate(event.data);}, false);
	evtSource.addEventListener("complete", function(event) { pageUpdate(event.data) ; if (DebugOnOff) document.getElementById("debugger").innerHTML = "got complete:" + event.data; }, false);
}
else {
	useServerSentEvents = false;
document.getElementById("refreshAllBox").classList.remove("hidden") ;
}

dataGetter("p", "", pageUpdate) ; // get all the data on startup



var PollCounter = 1 ;
function pollOnlyUpdates() { // some information I can only get if I ask for it, so that's what I do here

	dataGetter('get', 'ioSourceStatus', pageUpdate) ;
	dataGetter('get', 'ioOutputStatus', pageUpdate) ;

	if (PollCounter % 2 == 0) { // every 1 second

	}

	if (PollCounter % 30 == 0) { // every 15-ish seconds
		dataGetter('get', 'batteryChargePercent', pageUpdate) ; // ask for the battery charge level
	}


	if (!useServerSentEvents) { // no server-sent events; ask for updates
		if (PollCounter % 31 == 0)
			dataGetter('get', 'externalPower', pageUpdate) ; // check for external power connection

	}

	PollCounter++ ;
}



/* check cookies */

switch (getCookie("thm")) {
	case "":
		setCookie("thm", "dt") ;
	case "dt":
		theme("default") ;
		break ;

	case "mo":
		theme("monochrome") ;
		break ;

	case "dk":
		theme("darker") ;
		break ;

	case "lt":
		theme("lighter") ;
		break ;

	case "md":
		theme("monoDark") ;
		break ;

	case "l2":
		theme("newDefault") ;
		break ;
}




/*
	Cookie Descriptions:

	id	name / description
	---|-----------------------|
	fpl	"focus peaking level"	number from 0 to 1
	mc	"mode change"			"n" to change mode on navigation, "m" to change mode manually
	sr	"save recording"		0 when recording was saved, 1 when not saved
	thm	"theme"					2-letter code to indicate each theme
	wo	"warn overwrite"		"a" always warn, "n" never warn, "u" warn on unsaved recordings
	as	"auto save"				<= 0 to not auto save, > 0 to select device to save on
	ff	"file format"			0: H264, 1: DNG, 2: Tiff12, 3: Tiff16(Raw)

*/


var intervalID = setInterval(pollOnlyUpdates, 500) ; // poll the camera for things that are not reported





</script>
</html>



